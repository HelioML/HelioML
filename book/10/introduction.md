# Unsupervised Classification of Solar Wind Source Regions

The space between the Sun and the Earth is not empty. Instead, it is filled with streams of plasma (ions and electrons) called the solar wind, which travels nearly radially out from the Sun. Since the earliest spacecraft measurements, the solar wind has broadly been classified into two types, fast and slow, based solely its speed ([Neugebauer and Snyder, 1966](https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/JZ071i019p04469); [Stakhiv et al., 2015](https://iopscience.iop.org/article/10.1088/0004-637X/801/2/100)).

This duality has also been observed in measurements of the elemental composition and ion charge states of the solar wind, suggesting that the fast and slow wind originate from different solar source structures ([von Steiger et al., 2000](https://agupubs.onlinelibrary.wiley.com/doi/abs/10.1029/1999JA000358); [Geiss, Gloeckler, and Von Steiger, 1995](https://link.springer.com/article/10.1007%2FBF00768753)). Fast wind is found to originate from coronal holes ([Sheeley, Harvey, and Feldman, 1976](https://link.springer.com/article/10.1007%2FBF00162451)). These are magnetically open regions of the corona where the plasma can freely escape, meaning that coronal holes appear dark in EUV emission (since there is less time for the plasma to be heated). The formation and release of the slow wind is a current area of research, but it originates from the vicinity of closed coronal magnetic structures such as the streamer belt ([Antiochos et al., 2011](https://iopscience.iop.org/article/10.1088/0004-637X/731/2/112); [Ko et al., 2006](https://iopscience.iop.org/article/10.1086/505021); [Xu and Borovsky, 2015](https://agupubs.onlinelibrary.wiley.com/doi/full/10.1002/2014JA020412); [Brooks, Ugarte-Urra, and Warren, 2015](https://link.springer.com/article/10.1007/s11207-020-01609-z)).

While appealing, the traditional two-type solar wind paradigm is not unique, with a number of different observationally-determined solar wind types proposed. A two-type scheme has been proposed by [Zhao, Zurbuchen, and Fisk (2009)](https://doi.org/10.1029%2F2009GL039181), a three-type scheme has been proposed by [Stakhiv et al. (2015)](https://doi.org/10.1088%2F0004-637X%2F801%2F2%2F100), a four-type scheme has been proposed by [Xu and Borovsky (2015)](https://doi.org/10.1002%2F2014JA020412) and been built upon using supervised machine learning by [Camporeale, Carè, and Borovsky (2017)](https://doi.org/10.1002%2F2017JA024383), and even a six-type scheme has been proposed by [Zhao et al. (2017)](https://doi.org/10.3847/1538-4357/aa850c). In each of these categorisation schemes the properties of each solar wind type are quantitatively different from one another, an essential factor when performing statistical studies of heliospheric phenomena driven by the solar wind.

More recent work has sought to create classification schemes which rely on fewer subjective or preconcieved notions about the nature of the solar wind. To do this, unsupervised machine learning has been used to find and interpret the latent structures in the solar wind based on varieties of different measured variables. [Heidrich-Meisner and Wimmer-Schweingruber (2018)](https://linkinghub.elsevier.com/retrieve/pii/B9780128117880000160) have proposed a two-type classification scheme, and separate a two–seven type scheme (depending on interpretation) using the k-means clustering algorithm ([MacQueen, 1967](https://projecteuclid.org/euclid.bsmsp/1200512974)). Since then, work has tried to incorporate more complex methods, incorporating dimensional reduction to capture non-linear relations in the data: [Bloch et al.](https://link.springer.com/article/10.1007/s11207-020-01609-z) employ a Gaussian mixture model approach, and a dimension-reduction and clustering approach using UMAP and HDBSCAN (expanded upon below). [Amaya et al. (2020)](https://www.frontiersin.org/articles/10.3389/fspas.2020.553207/full) demonstrate the use of dynamic self-organising maps (DSOMs; [Rougier and Boniface, 2011](https://doi.org/10.1016/j.neucom.2010.06.034) and k-means to identify 6 clusters (correpsonding to 3 solar wind types) from solar wind data.

In this notebook, we will be performing unsupervised machine learning on solar wind data to see how such novel techniques can be used to gain insight into the solar wind. Specifically, we will demonstrate the application of a Bayesian Gaussian Mixture from the scikit-learn package, and we will also show how dimension reduction (UMAP) can be used in conjuction with clustering (HDBSCAN) to investigate a more complex parameter space for solar wind classification.

The analysis in this notebook is published in [Bloch et al, 2020, Solar Physics, 295, 41](https://link.springer.com/article/10.1007/s11207-020-01609-z). If you use any of this code, we ask that you cite the paper ([Bloch et al., 2020](https://link.springer.com/article/10.1007/s11207-020-01609-z)) and the code ([DOI: 10.5281/zenodo.4354341](https://doi.org/10.5281/zenodo.4354341)).

