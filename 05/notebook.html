
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Notebook &#8212; Machine Learning, Statistics, and Data Mining for Heliophysics</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Spectra of Flaring Active Regions" href="../06/Spectra_of_Flaring_Active_Regions.html" />
    <link rel="prev" title="Scintillation Prediction" href="Scintillation_Prediction.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Machine Learning, Statistics, and Data Mining for Heliophysics</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Front Matter
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../FrontMatter/acknowledgements.html">
   Acknowledgements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../FrontMatter/table_of_contents.html">
   Table of Contents
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  About This Book
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../01/whys_and_whats.html">
   What is this book and why does it exist?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01/example_fitting_time_series.html">
   An Example
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../01/other_references.html">
   Where to look for more information
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapter 1
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../02/Predicting_Coronal_Mass_Ejections.html">
   Predicting Coronal Mass Ejections
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../02/notebook.html">
   Notebook
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapter 2
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../03/Enhancing_SDO_images.html">
   Enhancing SDO Images
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../03/notebook.html">
   Notebook
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapter 3
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../04/Differential_Emission_Measurements.html">
   Differential Emission Measurements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../04/notebook.html">
   Notebook
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapter 4
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Scintillation_Prediction.html">
   Scintillation Prediction
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Notebook
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapter 5
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../06/Spectra_of_Flaring_Active_Regions.html">
   Spectra of Flaring Active Regions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../06/notebook.html">
   Notebook
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapter 6
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../07/Detection_of_Far-Side_Solar_Active_Regions.html">
   Detection of Far-Side Solar Active Regions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../07/notebook.html">
   Notebook
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapter 7
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../08/Automated_Detection_Of_Magnetopause_Crossings.html">
   Automated Detection of Magnetopause Crossings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../08/notebook.html">
   Notebook
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Chapter 8
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../09/Forecasting_Relativistic_Electrons_Outer_Radiation_Belt.html">
   Forecasting Megaelectron‐Volt Electrons Inside Earth’s Outer Radiation Belt With Machine Learning
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../09/notebook.html">
   Notebook
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../Appendix/how_to_run_this_book.html">
   How to run this book
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/05/notebook.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/HelioML/HelioML/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/HelioML/HelioML//issues/new?title=Issue%20on%20page%20%2F05/notebook.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/HelioML/HelioML/edit/master/book/05/notebook.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#abstract">
   Abstract
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-scintillation">
     What is scintillation?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#why-is-scintillation-important">
     Why is scintillation important?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#what-is-the-scope-of-this-work">
     What is the scope of this work?
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#how-is-machine-learning-applied-in-this-chapter">
     How is machine learning applied in this chapter?
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#flow-of-this-notebook">
       Flow of this notebook:
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-1-data-location-access">
   Step 1: Data location/access
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-2-machine-learning-database-ml-db-creation">
   Step 2: Machine learning database (ML DB) creation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visually-explore-the-data">
     Visually explore the data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#distribution-of-input-variables">
       Distribution of input variables
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#distributions-of-positive-and-negative-classes-by-individual-input-feature">
       Distributions of positive and negative classes by individual input feature
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-3-input-feature-selection">
   Step 3: Input feature selection
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-4-support-vector-machine-svm-training">
   Step 4: Support Vector Machine (SVM) training
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#step-5-svm-evaluation">
   Step 5: SVM evaluation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#determine-sensitivity-to-input-training-sample">
     Determine sensitivity to input training sample
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-data-from-2016-and-examine-svm-model-generalizability-by-examining-predictions-for-january-15-25-2016-period">
     Load data from 2016 and examine SVM model generalizability by examining predictions for January 15-25, 2016 period
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#take-a-look-at-the-confusion-matrix-to-understand-model-performance">
       Take a look at the confusion matrix to understand model performance
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="notebook">
<h1>Notebook<a class="headerlink" href="#notebook" title="Permalink to this headline">¶</a></h1>
<p>The purpose of this notebook is to detail the data science methodology used to produce classification (i.e., yes/no) predictions of high-latitude ionospheric phase scintillation.</p>
<p>The reference for this work is: <a class="reference external" href="https://doi.org/10.1029/2018SW002018">McGranaghan, R.M., A.J. Mannucci, B.D Wilson, C.A. Mattmann, and R. Chadwick. (2018), New capabilities for prediction of high‐latitude ionospheric scintillation: A novel approach with machine learning, Space Weather, 16</a>.</p>
<div class="section" id="abstract">
<h2>Abstract<a class="headerlink" href="#abstract" title="Permalink to this headline">¶</a></h2>
<p>As societal dependence on trans-ionospheric radio signals grows, understanding the impact of space weather on these signals is both increasingly important and remains unresolved. The challenge is particularly acute at high-latitudes where the effects of space weather are most direct and no reliable predictive capability exists. We take advantage of a large volume of data from Global Navigation Satellite Systems (GNSS) signals, increasingly sophisticated tools for data-driven discovery, and a machine learning algorithm known as the Support Vector Machine (SVM) to develop a novel predictive model for high-latitude ionospheric phase scintillation. This work, to our knowledge, represents the first time a SVM model has been created to predict high-latitude phase scintillation. We define a metric known as the Total Skill Score (TSS), which can be used to robustly compare between predictive methods, to evaluate the SVM model, thereby establishing a benchmark for high-latitude ionospheric phase scintillation. We find that the SVM model significantly outperforms persistence, doubling the predictive skill according to the TSS for a one hour predictive task. The increase in is even more pronounced as prediction time is increased. For a prediction time of three hours, persistence prediction is comparable to a random chance prediction, suggesting that the ‘memory’ of the ionosphere in terms of high-latitude plasma irregularities is on the order of or shorter than hours. The SVM model predictive skill only slightly decreases between the one and three hour predictive task, pointing to the potential of this method. Our findings can serve as a foundation on which to evaluate future predictive models, a critical development toward the resolution of space weather impact on trans-ionospheric radio signals.</p>
</div>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-is-scintillation">
<h3>What is scintillation?<a class="headerlink" href="#what-is-scintillation" title="Permalink to this headline">¶</a></h3>
<p>Irregularities in the density of the charged region of the upper atmosphere between ~100- and 1,000-km altitude—the ionosphere—cause rapid radio signal phase and intensity fluctuations in the frequency range between 100 MHz and 4 GHz (Aarons &amp; Basu, 1994; Basu et al., 1988; Kintner, 2001). These fluctuations are referred to as scintillation, and their study, particularly at high latitudes and in the context of recent advances in machine learning methodologies, is in its infancy.</p>
</div>
<div class="section" id="why-is-scintillation-important">
<h3>Why is scintillation important?<a class="headerlink" href="#why-is-scintillation-important" title="Permalink to this headline">¶</a></h3>
<p>Ionospheric scintillation is increasingly important as (1) our society becomes more dependent on Global Navigation Satellite Systems (GNSS) signals, which are critically affected by the ionosphere (Kintner et al., 2007), and (2) proliferation of technology and access to space drives a greater reliance on transionospheric signals (Tzelepis &amp; Carreno, 2016). Despite the frequent and deleterious effects of the ionosphere on radio signals there is a lack of awareness of, and appreciation for, mitigating these impacts on a given GNSS-dependent service. Due to the absence of robust prediction models, users are often unaware that disruptions should be attributed to ionospheric disturbances. This fact, exacerbated by the increasing demand on GNSS applications (e.g., Sadlier et al., 2017), motivates the pressing need for new predictive capabilities.</p>
</div>
<div class="section" id="what-is-the-scope-of-this-work">
<h3>What is the scope of this work?<a class="headerlink" href="#what-is-the-scope-of-this-work" title="Permalink to this headline">¶</a></h3>
<p>This chapter specifically focuses on scintillation at high latitudes (i.e., &gt;45 degrees), which is, in many respects, a more challenging problem than that at low and middle latitudes given the highly dynamic nature and influence of potentially much more significant nonlinear behavior. Further, the body of work to predict high-latitude ionospheric scintillation is very limited.</p>
<p>This chapter represents early work to bring machine learning methods to bear on high-latitude ionospheric scintillation prediction.</p>
</div>
<div class="section" id="how-is-machine-learning-applied-in-this-chapter">
<h3>How is machine learning applied in this chapter?<a class="headerlink" href="#how-is-machine-learning-applied-in-this-chapter" title="Permalink to this headline">¶</a></h3>
<p>While the proliferation of transionospheric radio signals and technologies dependent on them have produced a dire need to understand and predict scintillation, it has also created a much wider data set through which to study, understand, and, ultimately, predict the phenomenon. The operation of the <a class="reference external" href="http://www.igs.org/">United States’ Global Positioning System</a> constellation since 1993 coupled with the advent of Russian (Globalnaya Navigazionnaya Sputnikovaya Sistema), Chinese (<a class="reference external" href="http://www.beidou.gov.cn">Beidou</a>), and European (<a class="reference external" href="http://www.gsa.europa.eu/galileo/programme">Galileo</a>) systems and the proliferation of ground-based receivers and networks of receivers (e.g., <a class="reference external" href="http://www.igs.org/">the International GNSS Service high-latitude network</a>, (Cherniak et al., 2014), Canadian High Arctic Ionospheric Network <a class="reference external" href="http://chain.physics.unb.ca/chain/">CHAIN</a>, <a class="reference external" href="http://www.polar.dtu.dk/english/Research/Facilities/GNET">Greenland Global Positioning System Network</a>, <a class="reference external" href="http://www.eswua.ingv.it/ingv/home.php?res=1024">Istituto Nazionale di Geofisica e Vulcanologia Electronic Space Weather Upper Atmosphere</a>, <a class="reference external" href="http://datahouse1.gsi.go.jp/terras/terras_english.html">GNSS Earth Observation NETwork</a> provide a vast and powerful new data set through which ionospheric scintillation and, more generally, space weather can be studied (Beutler et al., 1999; Ren et al., 2016; Rizos et al., 2013). These data provide information at higher cadence and over a larger portion of the globe than any other single data set and are the premier remote sensing tools to facilitate new understanding of space weather phenomena (Coster &amp; Komjathy, 2008). GNSS data are voluminous (on the order of terabytes when considering data from the mid-1990s to now and taking into account the growing number of ground-based receivers) and heterogeneous (different satellite systems, receiver technologies, and archived in a variety of locations and formats). Appropriate utilization of these data can potentially revolutionize the study of space weather.</p>
<p>The presence of large volumes of underutilized data motivates the investigation of machine learning approaches. Machine learning here is broadly defined as any approach that allows a computer system to learn from experience introduced in the form of data samples. Our definition of machine learning encapsulates a broad range of approaches, including linear regression, clustering, information theory, statistical modeling, and neural networks, to name a few. There are, in general, three keys to successful machine learning: (1) availability of a large volume of high-quality data, (2) a well-defined task, and (3) adequate computational resources. The advent of GNSS signals coupled with long histories of ground-based GNSS signal observation address the first requirement. To address the second requirement, we examine the explicit task of predicting the occurrence of ionospheric scintillation at any given location with 1-hr lead time given input solar wind and geospace data (e.g., <a class="reference external" href="https://www.ngdc.noaa.gov/stp/geomag/indices.html">geomagnetic activity indices</a>). Finally, to satisfy the computational demand, machine learning often takes advantage of increased availability of computational resources (e.g., high-performance computing) that have become commonplace in the digital age (Duderstadt, 2001).</p>
<p>The emphasis of this chapter is to use an <em>explainable</em> machine learning technique known as support vector machines (SVMs) (Cortes and Vapnik, 1995) to establish new relationships between observed solar wind, geomagnetic activity, and ionospheric behavior and future phase scintillation occurrence in the high-latitude ionosphere without attempting to explain the complex and numerous physical mechanisms giving rise to ionospheric irregularities and the physical relationships that cause these irregularities to lead to scintillation for a given circumstance (i.e., at a given location with specific contextual conditions). We refer to the explainability of SVMs as the quality by which links are explicitly identified between the scintillation prediction and the input variables (for more information on explainable methods refer to, for example, the Defense Advance Research Projects Agency project, <a class="reference external" href="https://www.darpa.mil/program/explainable-artificial-intelligence">Explainable Artificial Intelligence</a>. SVMs are:</p>
<ol class="simple">
<li><p>capable of high accuracy;</p></li>
<li><p>flexible to model diverse data; and</p></li>
<li><p>handling high-dimensional data.</p></li>
</ol>
<div class="section" id="flow-of-this-notebook">
<h4>Flow of this notebook:<a class="headerlink" href="#flow-of-this-notebook" title="Permalink to this headline">¶</a></h4>
<ol class="simple">
<li><p>Data location/access</p>
<ul class="simple">
<li><p>This step details the locations that each of the data can be accessed.</p></li>
</ul>
</li>
<li><p>Machine learning database (ML DB) creation</p>
<ul class="simple">
<li><p>This step describes how the data are compiled into a ML DB, which is the form that is ready for use in machine learning algorithm training and testing.</p></li>
</ul>
</li>
<li><p>Input feature selection</p>
<ul class="simple">
<li><p>This step carries out the feature selection process (a univariate analysis of variance to identify the most informative input features).</p></li>
</ul>
</li>
<li><p>Support Vector Machine (SVM) training</p>
<ul class="simple">
<li><p>This step describes how the data are compiled into a machine learning database (ML DB), which is the form that is ready for use in machine learning algorithm training and testing.</p></li>
</ul>
</li>
<li><p>SVM evaluation</p>
<ul class="simple">
<li><p>This step evaluates the SVM model with various metrics using independent data.</p></li>
</ul>
</li>
</ol>
</div>
</div>
</div>
<div class="section" id="step-1-data-location-access">
<h2>Step 1: Data location/access<a class="headerlink" href="#step-1-data-location-access" title="Permalink to this headline">¶</a></h2>
<p>To do this work we will work with data from across the <a class="reference external" href="https://smd-prod.s3.amazonaws.com/science-red/s3fs-public/atoms/files/FLEETS_WIDE_Helio_2018_TAGGED.pdf">Heliophysics Observational System</a>, including from the sun, solar wind, geospace, and the ionosphere. Our ionospheric data will come from the <a class="reference external" href="http://chain.physics.unb.ca/chain/">Canadian High Arctic Ionospheric Network (CHAIN)</a>.</p>
<p>The CHAIN data are accessed via FTP server at <a class="reference external" href="http://chain.physics.unb.ca/chain/">http://chain.physics.unb.ca/chain/</a>. We download data from 2015-2016.</p>
</div>
<div class="section" id="step-2-machine-learning-database-ml-db-creation">
<h2>Step 2: Machine learning database (ML DB) creation<a class="headerlink" href="#step-2-machine-learning-database-ml-db-creation" title="Permalink to this headline">¶</a></h2>
<p>Generation of the machine learning database (ML DB) consists of creating data samples. Each data sample consists of <strong>input features</strong> and a <strong>label</strong>.</p>
<p>The input features come from three sources:</p>
<ol class="simple">
<li><p><a class="reference external" href="https://cdaweb.sci.gsfc.nasa.gov/">NASA’s Coordinated Data Analysis Web (CDAWeb)</a></p></li>
<li><p>The <a class="reference external" href="http://sourceforge.net/projects/ovation-prime/">Oval Variation, Assessment, Tracking, Intensity, and Online Nowcasting Prime (OVATION Prime)</a></p></li>
<li><p>The <a class="reference external" href="http://chain.physics.unb.ca/chain/">Canadian High Arctic Ionospheric Network (CHAIN)</a>.</p></li>
</ol>
<p>The label is the value of the phase scintillation index at a time in the future equal to the prediction time. This notebook uses a prediction time of one hour. Our labels indicate one of two values:</p>
<ol class="simple">
<li><p>The phase scintillation index is greater than 0.1 radians (<span class="math notranslate nohighlight">\(\sigma_{\Phi} &gt; 0.1\)</span>)  at the prediction time</p></li>
<li><p>The phase scintillation index is less than or equal to 0.1 radians (<span class="math notranslate nohighlight">\(\sigma_{\Phi} \leq 0.1\)</span>)  at the prediction time</p></li>
</ol>
<p>The ML DB generation process is detailed in [McGranaghan et al., (2018)]. Here, we simply read in the provided ML DB, which has been stored as a <em>csv</em> file and is read into a Pandas Dataframe.</p>
<p>First, we import necessary modules and set a few constants and then we read in the provided ML DB that is ready for application to machine learning algorithm training and testing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="kn">import</span> <span class="nn">itertools</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="n">scint_thresh</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># set the phase scintillation threshold</span>
<span class="n">scint_outlier_thresh</span> <span class="o">=</span> <span class="mf">5.</span> <span class="c1"># set the value that determines phase scintillation outliers (these data samples will be removed)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load the provided ML DB and clean the data</span>
<span class="c1">#   The following cleaning steps are applied to create the &#39;NaNsDropped&#39; csv file</span>
<span class="c1">#        1. All phase scintillation index values &gt; 5. are set to NaN</span>
<span class="c1">#        2. All data samples with NaN for any input feature are removed</span>

<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://ndownloader.figshare.com/files/12388631&#39;</span> <span class="c1"># FigShare: 2015</span>
<span class="c1"># url = &#39;https://ndownloader.figshare.com/files/12388670&#39; # FigShare: 2016</span>
   <span class="c1"># NOTE: it takes roughly six minutes to download the 2015 data</span>
   <span class="c1"># TO DO: ADD MONITORING BAR WHEN READING DATA IN</span>

<span class="n">ml_db</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="c1"># Drop two saved index columns</span>
<span class="n">ml_db</span> <span class="o">=</span> <span class="n">ml_db</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">ml_db</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span> 

<span class="c1"># Drop columns not used in our predictive task</span>
<span class="n">cols_to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;CHAIN station&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;CHAIN station model&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;CHAIN station ID number&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;AACGM local time [hr]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;sigmaPhi [radians]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;S4 [dimensionless]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;datetime at prediction time&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;ut at prediction time [sec]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;doy at prediction time [sec]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;TEC at prediction time [TECU]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;dTEC at prediction time [TECU]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;S4 at prediction time [dimensionless]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;S4 projected to vertical at prediction time [dimensionless]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;sigmaPhi at prediction time [radians]&#39;</span><span class="p">]</span>

<span class="n">ml_db</span> <span class="o">=</span> <span class="n">ml_db</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cols_to_remove</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Separate the ML DB into input (X) and label (y)</span>
<span class="n">predicted_label</span> <span class="o">=</span> <span class="s1">&#39;sigmaPhi projected to vertical at prediction time [radians]&#39;</span>
<span class="n">predicted_column</span> <span class="o">=</span> <span class="n">ml_db</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">predicted_label</span><span class="p">)</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">ml_db</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ml_db</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">predicted_label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">feature_labels</span> <span class="o">=</span> <span class="n">ml_db</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ml_db</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">predicted_label</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ml_db</span><span class="p">[</span><span class="n">predicted_label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine the structure of the ML DB</span>
<span class="n">ml_db</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>doy</th>
      <th>ut</th>
      <th>azimuth [deg]</th>
      <th>elevation [deg]</th>
      <th>Bz - 30min [nT]</th>
      <th>Bz - 15min [nT]</th>
      <th>Bz - 0min [nT]</th>
      <th>By - 30min [nT]</th>
      <th>By - 15min [nT]</th>
      <th>...</th>
      <th>sin(AACGM local time) [rad]</th>
      <th>geographic latitude [deg]</th>
      <th>geographic longitude [deg]</th>
      <th>TEC at current time [TECU]</th>
      <th>dTEC 0min-15s to 0min-0s [TECU]</th>
      <th>SI [dimensionless]</th>
      <th>spectral slope [dimensionless]</th>
      <th>S4 projected to vertical [dimensionless]</th>
      <th>sigmaPhi projected to vertical [radians]</th>
      <th>sigmaPhi projected to vertical at prediction time [radians]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1.0</td>
      <td>60.0</td>
      <td>198.0</td>
      <td>50.0</td>
      <td>2.07</td>
      <td>2.02</td>
      <td>1.05</td>
      <td>2.83</td>
      <td>0.54</td>
      <td>...</td>
      <td>-0.122172</td>
      <td>61.097941</td>
      <td>-94.071467</td>
      <td>20.611</td>
      <td>-0.017</td>
      <td>0.013</td>
      <td>1.96</td>
      <td>0.036745</td>
      <td>0.025491</td>
      <td>0.021767</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1.0</td>
      <td>120.0</td>
      <td>198.0</td>
      <td>50.0</td>
      <td>2.07</td>
      <td>2.02</td>
      <td>1.05</td>
      <td>2.83</td>
      <td>0.54</td>
      <td>...</td>
      <td>-0.105562</td>
      <td>61.097941</td>
      <td>-94.071467</td>
      <td>29.598</td>
      <td>-0.004</td>
      <td>0.011</td>
      <td>1.72</td>
      <td>0.032812</td>
      <td>0.022486</td>
      <td>0.018900</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1.0</td>
      <td>180.0</td>
      <td>198.0</td>
      <td>49.0</td>
      <td>2.30</td>
      <td>2.09</td>
      <td>2.01</td>
      <td>1.13</td>
      <td>-0.71</td>
      <td>...</td>
      <td>-0.088917</td>
      <td>61.097941</td>
      <td>-94.071467</td>
      <td>28.342</td>
      <td>-0.003</td>
      <td>0.010</td>
      <td>1.69</td>
      <td>0.036502</td>
      <td>0.023386</td>
      <td>0.020841</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>1.0</td>
      <td>240.0</td>
      <td>197.0</td>
      <td>49.0</td>
      <td>2.30</td>
      <td>2.09</td>
      <td>2.01</td>
      <td>1.13</td>
      <td>-0.71</td>
      <td>...</td>
      <td>-0.072240</td>
      <td>61.097941</td>
      <td>-94.071467</td>
      <td>21.468</td>
      <td>0.014</td>
      <td>0.012</td>
      <td>1.71</td>
      <td>0.037463</td>
      <td>0.025092</td>
      <td>0.022609</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>1.0</td>
      <td>300.0</td>
      <td>197.0</td>
      <td>49.0</td>
      <td>2.30</td>
      <td>2.09</td>
      <td>2.01</td>
      <td>1.13</td>
      <td>-0.71</td>
      <td>...</td>
      <td>-0.055536</td>
      <td>61.097941</td>
      <td>-94.071467</td>
      <td>23.001</td>
      <td>-0.004</td>
      <td>0.009</td>
      <td>1.73</td>
      <td>0.036502</td>
      <td>0.023470</td>
      <td>0.018837</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>1.0</td>
      <td>360.0</td>
      <td>197.0</td>
      <td>48.0</td>
      <td>2.30</td>
      <td>2.09</td>
      <td>2.01</td>
      <td>1.13</td>
      <td>-0.71</td>
      <td>...</td>
      <td>-0.038811</td>
      <td>61.097941</td>
      <td>-94.071467</td>
      <td>22.582</td>
      <td>-0.041</td>
      <td>0.010</td>
      <td>1.74</td>
      <td>0.031253</td>
      <td>0.020536</td>
      <td>0.020313</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>1.0</td>
      <td>420.0</td>
      <td>196.0</td>
      <td>48.0</td>
      <td>2.30</td>
      <td>2.09</td>
      <td>2.01</td>
      <td>1.13</td>
      <td>-0.71</td>
      <td>...</td>
      <td>-0.022068</td>
      <td>61.097941</td>
      <td>-94.071467</td>
      <td>23.991</td>
      <td>-0.010</td>
      <td>0.009</td>
      <td>1.81</td>
      <td>0.028343</td>
      <td>0.026084</td>
      <td>0.019900</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>1.0</td>
      <td>480.0</td>
      <td>196.0</td>
      <td>47.0</td>
      <td>2.08</td>
      <td>1.71</td>
      <td>1.84</td>
      <td>0.84</td>
      <td>-2.11</td>
      <td>...</td>
      <td>-0.005313</td>
      <td>61.097941</td>
      <td>-94.071467</td>
      <td>25.490</td>
      <td>0.017</td>
      <td>0.012</td>
      <td>1.73</td>
      <td>0.035574</td>
      <td>0.019788</td>
      <td>0.019313</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>1.0</td>
      <td>540.0</td>
      <td>196.0</td>
      <td>47.0</td>
      <td>2.08</td>
      <td>1.71</td>
      <td>1.84</td>
      <td>0.84</td>
      <td>-2.11</td>
      <td>...</td>
      <td>0.011450</td>
      <td>61.097941</td>
      <td>-94.071467</td>
      <td>25.776</td>
      <td>0.029</td>
      <td>0.010</td>
      <td>1.71</td>
      <td>0.028889</td>
      <td>0.021587</td>
      <td>0.019393</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>1.0</td>
      <td>600.0</td>
      <td>196.0</td>
      <td>47.0</td>
      <td>2.08</td>
      <td>1.71</td>
      <td>1.84</td>
      <td>0.84</td>
      <td>-2.11</td>
      <td>...</td>
      <td>0.028216</td>
      <td>61.097941</td>
      <td>-94.071467</td>
      <td>25.043</td>
      <td>-0.006</td>
      <td>0.011</td>
      <td>1.74</td>
      <td>0.030575</td>
      <td>0.021111</td>
      <td>0.020038</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 53 columns</p>
</div></div></div>
</div>
<div class="section" id="visually-explore-the-data">
<h3>Visually explore the data<a class="headerlink" href="#visually-explore-the-data" title="Permalink to this headline">¶</a></h3>
<div class="section" id="distribution-of-input-variables">
<h4>Distribution of input variables<a class="headerlink" href="#distribution-of-input-variables" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="k">as</span> <span class="nn">cm</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdat</span>
<span class="kn">import</span> <span class="nn">matplotlib.mlab</span> <span class="k">as</span> <span class="nn">mlab</span><span class="o">,</span> <span class="nn">mpld3</span>

<span class="c1"># Choose the feature to plot</span>
<span class="c1">#      NOTE: you can input any of the column names from &#39;ml_db&#39;</span>
<span class="n">feature_i</span> <span class="o">=</span> <span class="n">ml_db</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;Bz - 30min [nT]&#39;</span><span class="p">)</span>
<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="c1"># fig.set_size_inches(8,10)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X</span><span class="p">[:,</span><span class="n">feature_i</span><span class="p">],</span> <span class="n">num_bins</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">feature_labels</span><span class="p">[</span><span class="n">feature_i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="c1">#, labelpad=-30)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Normalized probability&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="c1">#, labelpad=-30)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/notebook_10_0.png" src="../_images/notebook_10_0.png" />
</div>
</div>
</div>
<div class="section" id="distributions-of-positive-and-negative-classes-by-individual-input-feature">
<h4>Distributions of positive and negative classes by individual input feature<a class="headerlink" href="#distributions-of-positive-and-negative-classes-by-individual-input-feature" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Examine distribution of one feature for the positive and negative class </span>

<span class="c1"># Separate the positive and negative classes</span>
<span class="n">idx_pos_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="mf">0.1</span><span class="p">)</span> <span class="p">)</span>
<span class="n">idx_neg_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">y</span> <span class="o">&lt;=</span> <span class="mf">0.1</span><span class="p">)</span> <span class="p">)</span>
<span class="n">X_pos_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X_pos_class</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">idx_pos_class</span><span class="p">,:]</span>
<span class="n">X_neg_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">X_neg_class</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">idx_neg_class</span><span class="p">,:]</span>
<span class="n">y_pos_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">y_pos_class</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">idx_pos_class</span><span class="p">]</span>
<span class="n">y_neg_class</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">y_neg_class</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">idx_neg_class</span><span class="p">]</span>

<span class="c1"># choose the feature to plot</span>
<span class="n">feature_i</span> <span class="o">=</span> <span class="n">ml_db</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s1">&#39;Bz - 30min [nT]&#39;</span><span class="p">)</span>

<span class="n">num_bins</span> <span class="o">=</span> <span class="mi">20</span>

<span class="c1"># For the positive class</span>
<span class="n">mu_scint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X_pos_class</span><span class="p">[:,</span><span class="n">feature_i</span><span class="p">])</span>
<span class="n">sigma_scint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">X_pos_class</span><span class="p">[:,</span><span class="n">feature_i</span><span class="p">])</span>
<span class="n">n_scint</span><span class="p">,</span> <span class="n">bins_scint</span><span class="p">,</span> <span class="n">patches_scint</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X_pos_class</span><span class="p">[:,</span><span class="n">feature_i</span><span class="p">],</span> <span class="n">num_bins</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">y_scint</span>  <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">bins_scint</span><span class="p">,</span> <span class="n">mu_scint</span><span class="p">,</span> <span class="n">sigma_scint</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins_scint</span><span class="p">,</span> <span class="n">y_scint</span><span class="p">,</span> <span class="s1">&#39;g--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;positive class&#39;</span><span class="p">)</span>

<span class="c1"># For the negative class</span>
<span class="n">mu_noscint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">X_neg_class</span><span class="p">[:,</span><span class="n">feature_i</span><span class="p">])</span>
<span class="n">sigma_noscint</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">X_neg_class</span><span class="p">[:,</span><span class="n">feature_i</span><span class="p">])</span>
<span class="n">n_noscint</span><span class="p">,</span> <span class="n">bins_noscint</span><span class="p">,</span> <span class="n">patches_noscint</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">X_neg_class</span><span class="p">[:,</span><span class="n">feature_i</span><span class="p">],</span> <span class="n">num_bins</span><span class="p">,</span> <span class="n">normed</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">y_noscint</span>  <span class="o">=</span> <span class="n">mlab</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">bins_noscint</span><span class="p">,</span> <span class="n">mu_noscint</span><span class="p">,</span> <span class="n">sigma_noscint</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bins_noscint</span><span class="p">,</span> <span class="n">y_noscint</span><span class="p">,</span> <span class="s1">&#39;r--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;negative class&#39;</span><span class="p">)</span>


<span class="n">text_style</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;monospace&#39;</span><span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized &#39;</span><span class="o">+</span><span class="n">feature_labels</span><span class="p">[</span><span class="n">feature_i</span><span class="p">],</span><span class="o">**</span><span class="n">text_style</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Number (normalized)&#39;</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="o">**</span><span class="n">text_style</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<span class="c1">#fig.savefig(&#39;featureDist_tmp.png&#39;,bbox_inches=&#39;tight&#39;)</span>
<span class="n">legend</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">framealpha</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="c1">#legend.get_frame().set_linewidth(0.0)</span>
<span class="n">mpld3</span><span class="o">.</span><span class="n">enable_notebook</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># NOTE: the smaller the difference between features, the less helpful they are to the prediction</span>
<span class="c1">#     Try varying &#39;feature_i&#39; to see which features are useless</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">

<style>

</style>

<div id="fig_el7321545716336163488751959"></div>
<script>
function mpld3_load_lib(url, callback){
  var s = document.createElement('script');
  s.src = url;
  s.async = true;
  s.onreadystatechange = s.onload = callback;
  s.onerror = function(){console.warn("failed to load library " + url);};
  document.getElementsByTagName("head")[0].appendChild(s);
}

if(typeof(mpld3) !== "undefined" && mpld3._mpld3IsLoaded){
   // already loaded: just create the figure
   !function(mpld3){

       mpld3.draw_figure("fig_el7321545716336163488751959", {"axes": [{"xlim": [-29.93050003052, 34.54050064092], "yscale": "linear", "axesbg": "#FFFFFF", "texts": [{"v_baseline": "hanging", "h_anchor": "middle", "color": "#000000", "text": "Normalized Bz - 30min [nT]", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 16.0, "position": [0.5, -0.07726269315673287], "rotation": -0.0, "id": "el732154571629264"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Number (normalized)", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 16.0, "position": [-0.08826164874551971, 0.5], "rotation": -90.0, "id": "el732154571597648"}, {"v_baseline": "auto", "h_anchor": "start", "color": "#000000", "text": "positive class", "coordinates": "axes", "zorder": 1000003.0, "alpha": 1, "fontsize": 12.0, "position": [0.825179211469534, 0.9234731420161886], "rotation": -0.0, "id": "el732154517566416"}, {"v_baseline": "auto", "h_anchor": "start", "color": "#000000", "text": "negative class", "coordinates": "axes", "zorder": 1000003.0, "alpha": 1, "fontsize": 12.0, "position": [0.825179211469534, 0.8535688005886684], "rotation": -0.0, "id": "el732154580902096"}], "zoomable": true, "images": [], "xdomain": [-29.93050003052, 34.54050064092], "ylim": [0.0, 0.1319991168390634], "paths": [{"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data02", "id": "el732154573001744"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data03", "id": "el732154573001168"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data04", "id": "el732154573002512"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data05", "id": "el732154573003408"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data06", "id": "el732154573041168"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data07", "id": "el732154573042064"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data08", "id": "el732154573042960"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data09", "id": "el732154573043856"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data10", "id": "el732154573044624"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data11", "id": "el732154573090768"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data12", "id": "el732154573091664"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data13", "id": "el732154573092560"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data14", "id": "el732154573093456"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data15", "id": "el732154573151760"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data16", "id": "el732154573152656"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data17", "id": "el732154573153552"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data18", "id": "el732154573154448"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data19", "id": "el732154573155216"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data20", "id": "el732154573201360"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data21", "id": "el732154573202256"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data02", "id": "el732154573254608"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data03", "id": "el732154573254032"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data04", "id": "el732154573255376"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data05", "id": "el732154573256336"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data06", "id": "el732154573257168"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data07", "id": "el732154573303184"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data08", "id": "el732154573304080"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data09", "id": "el732154573304976"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data10", "id": "el732154573305872"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data11", "id": "el732154573306768"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data12", "id": "el732154573348688"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data13", "id": "el732154573349584"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data14", "id": "el732154573350480"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data15", "id": "el732154573351376"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data16", "id": "el732154573397392"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data17", "id": "el732154573398288"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data18", "id": "el732154573399184"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data19", "id": "el732154573400080"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data20", "id": "el732154573400976"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data21", "id": "el732154573451088"}, {"edgecolor": "none", "facecolor": "none", "edgewidth": 1.0, "pathcodes": ["M", "L", "S", "L", "S", "L", "S", "L", "S", "Z"], "yindex": 1, "coordinates": "axes", "dasharray": "10,0", "zorder": 1000001.0, "alpha": 0.0, "xindex": 0, "data": "data23", "id": "el732154573453456"}], "sharey": [], "sharex": [], "axesbgalpha": null, "axes": [{"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "fontsize": 10.0, "position": "bottom", "nticks": 8, "tickvalues": null}, {"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "fontsize": 10.0, "position": "left", "nticks": 8, "tickvalues": null}], "lines": [{"color": "#007F00", "yindex": 1, "coordinates": "data", "dasharray": "5.55,2.4", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el732154573001040"}, {"color": "#FF0000", "yindex": 2, "coordinates": "data", "dasharray": "5.55,2.4", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el732154573253840"}, {"color": "#007F00", "yindex": 1, "coordinates": "axes", "dasharray": "5.55,2.4", "zorder": 1000002.0, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data22", "id": "el732154573454288"}, {"color": "#FF0000", "yindex": 2, "coordinates": "axes", "dasharray": "5.55,2.4", "zorder": 1000002.0, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data22", "id": "el732154580902608"}], "markers": [], "id": "el732154571635024", "ydomain": [0.0, 0.1319991168390634], "collections": [], "xscale": "linear", "bbox": [0.125, 0.125, 0.775, 0.755]}], "height": 360.0, "width": 720.0, "plugins": [{"type": "reset"}, {"enabled": false, "button": true, "type": "zoom"}, {"enabled": false, "button": true, "type": "boxzoom"}], "data": {"data06": [[-15.27799987792, 0.0, 0.0], [-12.347499847399998, 0.0, 0.0], [-12.347499847399998, 0.00906716469695808, 0.0008863064028688934], [-15.27799987792, 0.00906716469695808, 0.0008863064028688934]], "data08": [[-9.41699981688, 0.0, 0.0], [-6.48649978636, 0.0, 0.0], [-6.48649978636, 0.029324323285264325, 0.00814019896319494], [-9.41699981688, 0.029324323285264325, 0.00814019896319494]], "data09": [[-6.48649978636, 0.0, 0.0], [-3.5559997558399985, 0.0, 0.0], [-3.5559997558399985, 0.06126192250982954, 0.032030005911082994], [-6.48649978636, 0.06126192250982954, 0.032030005911082994]], "data20": [[25.749000549360005, 0.0, 0.0], [28.679500579880006, 0.0, 0.0], [28.679500579880006, 4.880067113540411e-06, 1.2857595556036815e-05], [25.749000549360005, 4.880067113540411e-06, 1.2857595556036815e-05]], "data21": [[28.679500579880006, 0.0, 0.0], [31.6100006104, 0.0, 0.0], [31.6100006104, 4.880067113540434e-06, 8.519143067803573e-06], [28.679500579880006, 4.880067113540434e-06, 8.519143067803573e-06]], "data22": [[0.764964157706093, 0.9389256806475351, 0.8690213392200149], [0.8079749103942651, 0.9389256806475351, 0.8690213392200149]], "data05": [[-18.20849990844, 0.0, 0.0], [-15.27799987792, 0.0, 0.0], [-15.27799987792, 0.006222085569764024, 0.0006932847076196783], [-18.20849990844, 0.006222085569764024, 0.0006932847076196783]], "data02": [[-27.0, 0.0, 0.0], [-24.06949996948, 0.0, 0.0], [-24.06949996948, 0.0001878825838713058, 6.941523981173248e-06], [-27.0, 0.0001878825838713058, 6.941523981173248e-06]], "data04": [[-21.138999938959998, 0.0, 0.0], [-18.20849990844, 0.0, 0.0], [-18.20849990844, 0.0017397439259771606, 0.0002698517447681107], [-21.138999938959998, 0.0017397439259771606, 0.0002698517447681107]], "data01": [[-27.0, 1.2510158185326837e-06, 3.402148637038758e-13], [-24.06949996948, 1.4679995451412345e-05, 7.77931921378068e-11], [-21.138999938959998, 0.0001261957054457412, 9.540696119895418e-09], [-18.20849990844, 0.000794728459111368, 6.275794239237008e-07], [-15.27799987792, 0.0036664729882356153, 2.214152302739422e-05], [-12.347499847399998, 0.012391781559902424, 0.0004189830440176699], [-9.41699981688, 0.030681355542180554, 0.004252414265404293], [-6.48649978636, 0.05565073088964497, 0.023148606210646717], [-3.5559997558399985, 0.07394737067551162, 0.06758717428915056], [-0.6254997253199974, 0.07198303196407828, 0.10584099019872663], [2.3050003052000037, 0.05133257722660622, 0.08889834191220669], [5.235500335720005, 0.026817083104422927, 0.040048254238764715], [8.166000366239999, 0.01026326497048705, 0.00967661984628424], [11.09650039676, 0.0028774983270843375, 0.0012540473425793747], [14.02700042728, 0.0005910172449834048, 8.716745106529495e-05], [16.957500457800002, 8.892845789693055e-05, 3.2497123656776868e-06], [19.888000488320003, 9.802501205418384e-06, 6.49808908977726e-08], [22.818500518840004, 7.915686438904463e-07, 6.969097838423678e-10], [25.749000549360005, 4.6826941757603034e-08, 4.008829852706381e-12], [28.679500579880006, 2.0293574159191406e-09, 1.2368266886782716e-14], [31.6100006104, 6.442832273552862e-11, 2.0466813596639995e-17]], "data23": [[0.7606630824372759, 0.824871228844739], [0.9849462365591398, 0.824871228844739], [0.9892473118279571, 0.824871228844739], [0.9892473118279571, 0.8337012509197941], [0.9892473118279571, 0.9690949227373071], [0.9892473118279571, 0.9779249448123624], [0.9849462365591398, 0.9779249448123624], [0.7606630824372759, 0.9779249448123624], [0.7563620071684587, 0.9779249448123624], [0.7563620071684587, 0.9690949227373071], [0.7563620071684587, 0.8337012509197941], [0.7563620071684587, 0.824871228844739], [0.7606630824372759, 0.824871228844739]], "data03": [[-24.06949996948, 0.0, 0.0], [-21.138999938959998, 0.0, 0.0], [-21.138999938959998, 0.001080934865649201, 8.21939544134378e-05], [-24.06949996948, 0.001080934865649201, 8.21939544134378e-05]], "data07": [[-12.347499847399998, 0.0, 0.0], [-9.41699981688, 0.0, 0.0], [-9.41699981688, 0.009316048119748666, 0.002062815836723433], [-12.347499847399998, 0.009316048119748666, 0.002062815836723433]], "data19": [[22.818500518840004, 0.0, 0.0], [25.749000549360005, 0.0, 0.0], [25.749000549360005, 3.172043623801267e-05, 2.934371501132328e-05], [22.818500518840004, 3.172043623801267e-05, 2.934371501132328e-05]], "data18": [[19.888000488320003, 0.0, 0.0], [22.818500518840004, 0.0, 0.0], [22.818500518840004, 9.02812416004976e-05, 3.178902459560022e-05], [19.888000488320003, 9.02812416004976e-05, 3.178902459560022e-05]], "data15": [[11.09650039676, 0.0, 0.0], [14.02700042728, 0.0, 0.0], [14.02700042728, 0.001976427180983866, 0.0019892987872864565], [11.09650039676, 0.001976427180983866, 0.0019892987872864565]], "data14": [[8.166000366239999, 0.0, 0.0], [11.09650039676, 0.0, 0.0], [11.09650039676, 0.0029036399325565437, 0.004393905799128336], [8.166000366239999, 0.0029036399325565437, 0.004393905799128336]], "data17": [[16.957500457800002, 0.0, 0.0], [19.888000488320003, 0.0, 0.0], [19.888000488320003, 0.00015616214763329315, 0.0002327776962322984], [16.957500457800002, 0.00015616214763329315, 0.0002327776962322984]], "data16": [[14.02700042728, 0.0, 0.0], [16.957500457800002, 0.0, 0.0], [16.957500457800002, 0.0009198926509023674, 0.0006035181815904151], [14.02700042728, 0.0009198926509023674, 0.0006035181815904151]], "data11": [[-0.6254997253199974, 0.0, 0.0], [2.3050003052000037, 0.0, 0.0], [2.3050003052000037, 0.08065530921903914, 0.12571344460863182], [-0.6254997253199974, 0.08065530921903914, 0.12571344460863182]], "data10": [[-3.5559997558399985, 0.0, 0.0], [-0.6254997253199974, 0.0, 0.0], [-0.6254997253199974, 0.09364116780817015, 0.09552128605251878], [-3.5559997558399985, 0.09364116780817015, 0.09552128605251878]], "data13": [[5.235500335720005, 0.0, 0.0], [8.166000366239999, 0.0, 0.0], [8.166000366239999, 0.009367288824440864, 0.013270142947190696], [5.235500335720005, 0.009367288824440864, 0.013270142947190696]], "data12": [[2.3050003052000037, 0.0, 0.0], [5.235500335720005, 0.0, 0.0], [5.235500335720005, 0.033286937781459136, 0.05526021031885093], [2.3050003052000037, 0.033286937781459136, 0.05526021031885093]]}, "id": "el732154571633616"});
   }(mpld3);
}else if(typeof define === "function" && define.amd){
   // require.js is available: use it to load d3/mpld3
   require.config({paths: {d3: "https://mpld3.github.io/js/d3.v3.min"}});
   require(["d3"], function(d3){
      window.d3 = d3;
      mpld3_load_lib("https://mpld3.github.io/js/mpld3.v0.2.js", function(){

         mpld3.draw_figure("fig_el7321545716336163488751959", {"axes": [{"xlim": [-29.93050003052, 34.54050064092], "yscale": "linear", "axesbg": "#FFFFFF", "texts": [{"v_baseline": "hanging", "h_anchor": "middle", "color": "#000000", "text": "Normalized Bz - 30min [nT]", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 16.0, "position": [0.5, -0.07726269315673287], "rotation": -0.0, "id": "el732154571629264"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Number (normalized)", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 16.0, "position": [-0.08826164874551971, 0.5], "rotation": -90.0, "id": "el732154571597648"}, {"v_baseline": "auto", "h_anchor": "start", "color": "#000000", "text": "positive class", "coordinates": "axes", "zorder": 1000003.0, "alpha": 1, "fontsize": 12.0, "position": [0.825179211469534, 0.9234731420161886], "rotation": -0.0, "id": "el732154517566416"}, {"v_baseline": "auto", "h_anchor": "start", "color": "#000000", "text": "negative class", "coordinates": "axes", "zorder": 1000003.0, "alpha": 1, "fontsize": 12.0, "position": [0.825179211469534, 0.8535688005886684], "rotation": -0.0, "id": "el732154580902096"}], "zoomable": true, "images": [], "xdomain": [-29.93050003052, 34.54050064092], "ylim": [0.0, 0.1319991168390634], "paths": [{"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data02", "id": "el732154573001744"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data03", "id": "el732154573001168"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data04", "id": "el732154573002512"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data05", "id": "el732154573003408"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data06", "id": "el732154573041168"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data07", "id": "el732154573042064"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data08", "id": "el732154573042960"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data09", "id": "el732154573043856"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data10", "id": "el732154573044624"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data11", "id": "el732154573090768"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data12", "id": "el732154573091664"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data13", "id": "el732154573092560"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data14", "id": "el732154573093456"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data15", "id": "el732154573151760"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data16", "id": "el732154573152656"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data17", "id": "el732154573153552"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data18", "id": "el732154573154448"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data19", "id": "el732154573155216"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data20", "id": "el732154573201360"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data21", "id": "el732154573202256"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data02", "id": "el732154573254608"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data03", "id": "el732154573254032"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data04", "id": "el732154573255376"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data05", "id": "el732154573256336"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data06", "id": "el732154573257168"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data07", "id": "el732154573303184"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data08", "id": "el732154573304080"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data09", "id": "el732154573304976"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data10", "id": "el732154573305872"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data11", "id": "el732154573306768"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data12", "id": "el732154573348688"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data13", "id": "el732154573349584"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data14", "id": "el732154573350480"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data15", "id": "el732154573351376"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data16", "id": "el732154573397392"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data17", "id": "el732154573398288"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data18", "id": "el732154573399184"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data19", "id": "el732154573400080"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data20", "id": "el732154573400976"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data21", "id": "el732154573451088"}, {"edgecolor": "none", "facecolor": "none", "edgewidth": 1.0, "pathcodes": ["M", "L", "S", "L", "S", "L", "S", "L", "S", "Z"], "yindex": 1, "coordinates": "axes", "dasharray": "10,0", "zorder": 1000001.0, "alpha": 0.0, "xindex": 0, "data": "data23", "id": "el732154573453456"}], "sharey": [], "sharex": [], "axesbgalpha": null, "axes": [{"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "fontsize": 10.0, "position": "bottom", "nticks": 8, "tickvalues": null}, {"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "fontsize": 10.0, "position": "left", "nticks": 8, "tickvalues": null}], "lines": [{"color": "#007F00", "yindex": 1, "coordinates": "data", "dasharray": "5.55,2.4", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el732154573001040"}, {"color": "#FF0000", "yindex": 2, "coordinates": "data", "dasharray": "5.55,2.4", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el732154573253840"}, {"color": "#007F00", "yindex": 1, "coordinates": "axes", "dasharray": "5.55,2.4", "zorder": 1000002.0, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data22", "id": "el732154573454288"}, {"color": "#FF0000", "yindex": 2, "coordinates": "axes", "dasharray": "5.55,2.4", "zorder": 1000002.0, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data22", "id": "el732154580902608"}], "markers": [], "id": "el732154571635024", "ydomain": [0.0, 0.1319991168390634], "collections": [], "xscale": "linear", "bbox": [0.125, 0.125, 0.775, 0.755]}], "height": 360.0, "width": 720.0, "plugins": [{"type": "reset"}, {"enabled": false, "button": true, "type": "zoom"}, {"enabled": false, "button": true, "type": "boxzoom"}], "data": {"data06": [[-15.27799987792, 0.0, 0.0], [-12.347499847399998, 0.0, 0.0], [-12.347499847399998, 0.00906716469695808, 0.0008863064028688934], [-15.27799987792, 0.00906716469695808, 0.0008863064028688934]], "data08": [[-9.41699981688, 0.0, 0.0], [-6.48649978636, 0.0, 0.0], [-6.48649978636, 0.029324323285264325, 0.00814019896319494], [-9.41699981688, 0.029324323285264325, 0.00814019896319494]], "data09": [[-6.48649978636, 0.0, 0.0], [-3.5559997558399985, 0.0, 0.0], [-3.5559997558399985, 0.06126192250982954, 0.032030005911082994], [-6.48649978636, 0.06126192250982954, 0.032030005911082994]], "data20": [[25.749000549360005, 0.0, 0.0], [28.679500579880006, 0.0, 0.0], [28.679500579880006, 4.880067113540411e-06, 1.2857595556036815e-05], [25.749000549360005, 4.880067113540411e-06, 1.2857595556036815e-05]], "data21": [[28.679500579880006, 0.0, 0.0], [31.6100006104, 0.0, 0.0], [31.6100006104, 4.880067113540434e-06, 8.519143067803573e-06], [28.679500579880006, 4.880067113540434e-06, 8.519143067803573e-06]], "data22": [[0.764964157706093, 0.9389256806475351, 0.8690213392200149], [0.8079749103942651, 0.9389256806475351, 0.8690213392200149]], "data05": [[-18.20849990844, 0.0, 0.0], [-15.27799987792, 0.0, 0.0], [-15.27799987792, 0.006222085569764024, 0.0006932847076196783], [-18.20849990844, 0.006222085569764024, 0.0006932847076196783]], "data02": [[-27.0, 0.0, 0.0], [-24.06949996948, 0.0, 0.0], [-24.06949996948, 0.0001878825838713058, 6.941523981173248e-06], [-27.0, 0.0001878825838713058, 6.941523981173248e-06]], "data04": [[-21.138999938959998, 0.0, 0.0], [-18.20849990844, 0.0, 0.0], [-18.20849990844, 0.0017397439259771606, 0.0002698517447681107], [-21.138999938959998, 0.0017397439259771606, 0.0002698517447681107]], "data01": [[-27.0, 1.2510158185326837e-06, 3.402148637038758e-13], [-24.06949996948, 1.4679995451412345e-05, 7.77931921378068e-11], [-21.138999938959998, 0.0001261957054457412, 9.540696119895418e-09], [-18.20849990844, 0.000794728459111368, 6.275794239237008e-07], [-15.27799987792, 0.0036664729882356153, 2.214152302739422e-05], [-12.347499847399998, 0.012391781559902424, 0.0004189830440176699], [-9.41699981688, 0.030681355542180554, 0.004252414265404293], [-6.48649978636, 0.05565073088964497, 0.023148606210646717], [-3.5559997558399985, 0.07394737067551162, 0.06758717428915056], [-0.6254997253199974, 0.07198303196407828, 0.10584099019872663], [2.3050003052000037, 0.05133257722660622, 0.08889834191220669], [5.235500335720005, 0.026817083104422927, 0.040048254238764715], [8.166000366239999, 0.01026326497048705, 0.00967661984628424], [11.09650039676, 0.0028774983270843375, 0.0012540473425793747], [14.02700042728, 0.0005910172449834048, 8.716745106529495e-05], [16.957500457800002, 8.892845789693055e-05, 3.2497123656776868e-06], [19.888000488320003, 9.802501205418384e-06, 6.49808908977726e-08], [22.818500518840004, 7.915686438904463e-07, 6.969097838423678e-10], [25.749000549360005, 4.6826941757603034e-08, 4.008829852706381e-12], [28.679500579880006, 2.0293574159191406e-09, 1.2368266886782716e-14], [31.6100006104, 6.442832273552862e-11, 2.0466813596639995e-17]], "data23": [[0.7606630824372759, 0.824871228844739], [0.9849462365591398, 0.824871228844739], [0.9892473118279571, 0.824871228844739], [0.9892473118279571, 0.8337012509197941], [0.9892473118279571, 0.9690949227373071], [0.9892473118279571, 0.9779249448123624], [0.9849462365591398, 0.9779249448123624], [0.7606630824372759, 0.9779249448123624], [0.7563620071684587, 0.9779249448123624], [0.7563620071684587, 0.9690949227373071], [0.7563620071684587, 0.8337012509197941], [0.7563620071684587, 0.824871228844739], [0.7606630824372759, 0.824871228844739]], "data03": [[-24.06949996948, 0.0, 0.0], [-21.138999938959998, 0.0, 0.0], [-21.138999938959998, 0.001080934865649201, 8.21939544134378e-05], [-24.06949996948, 0.001080934865649201, 8.21939544134378e-05]], "data07": [[-12.347499847399998, 0.0, 0.0], [-9.41699981688, 0.0, 0.0], [-9.41699981688, 0.009316048119748666, 0.002062815836723433], [-12.347499847399998, 0.009316048119748666, 0.002062815836723433]], "data19": [[22.818500518840004, 0.0, 0.0], [25.749000549360005, 0.0, 0.0], [25.749000549360005, 3.172043623801267e-05, 2.934371501132328e-05], [22.818500518840004, 3.172043623801267e-05, 2.934371501132328e-05]], "data18": [[19.888000488320003, 0.0, 0.0], [22.818500518840004, 0.0, 0.0], [22.818500518840004, 9.02812416004976e-05, 3.178902459560022e-05], [19.888000488320003, 9.02812416004976e-05, 3.178902459560022e-05]], "data15": [[11.09650039676, 0.0, 0.0], [14.02700042728, 0.0, 0.0], [14.02700042728, 0.001976427180983866, 0.0019892987872864565], [11.09650039676, 0.001976427180983866, 0.0019892987872864565]], "data14": [[8.166000366239999, 0.0, 0.0], [11.09650039676, 0.0, 0.0], [11.09650039676, 0.0029036399325565437, 0.004393905799128336], [8.166000366239999, 0.0029036399325565437, 0.004393905799128336]], "data17": [[16.957500457800002, 0.0, 0.0], [19.888000488320003, 0.0, 0.0], [19.888000488320003, 0.00015616214763329315, 0.0002327776962322984], [16.957500457800002, 0.00015616214763329315, 0.0002327776962322984]], "data16": [[14.02700042728, 0.0, 0.0], [16.957500457800002, 0.0, 0.0], [16.957500457800002, 0.0009198926509023674, 0.0006035181815904151], [14.02700042728, 0.0009198926509023674, 0.0006035181815904151]], "data11": [[-0.6254997253199974, 0.0, 0.0], [2.3050003052000037, 0.0, 0.0], [2.3050003052000037, 0.08065530921903914, 0.12571344460863182], [-0.6254997253199974, 0.08065530921903914, 0.12571344460863182]], "data10": [[-3.5559997558399985, 0.0, 0.0], [-0.6254997253199974, 0.0, 0.0], [-0.6254997253199974, 0.09364116780817015, 0.09552128605251878], [-3.5559997558399985, 0.09364116780817015, 0.09552128605251878]], "data13": [[5.235500335720005, 0.0, 0.0], [8.166000366239999, 0.0, 0.0], [8.166000366239999, 0.009367288824440864, 0.013270142947190696], [5.235500335720005, 0.009367288824440864, 0.013270142947190696]], "data12": [[2.3050003052000037, 0.0, 0.0], [5.235500335720005, 0.0, 0.0], [5.235500335720005, 0.033286937781459136, 0.05526021031885093], [2.3050003052000037, 0.033286937781459136, 0.05526021031885093]]}, "id": "el732154571633616"});
      });
    });
}else{
    // require.js not available: dynamically load d3 & mpld3
    mpld3_load_lib("https://mpld3.github.io/js/d3.v3.min.js", function(){
         mpld3_load_lib("https://mpld3.github.io/js/mpld3.v0.2.js", function(){

                 mpld3.draw_figure("fig_el7321545716336163488751959", {"axes": [{"xlim": [-29.93050003052, 34.54050064092], "yscale": "linear", "axesbg": "#FFFFFF", "texts": [{"v_baseline": "hanging", "h_anchor": "middle", "color": "#000000", "text": "Normalized Bz - 30min [nT]", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 16.0, "position": [0.5, -0.07726269315673287], "rotation": -0.0, "id": "el732154571629264"}, {"v_baseline": "auto", "h_anchor": "middle", "color": "#000000", "text": "Number (normalized)", "coordinates": "axes", "zorder": 3, "alpha": 1, "fontsize": 16.0, "position": [-0.08826164874551971, 0.5], "rotation": -90.0, "id": "el732154571597648"}, {"v_baseline": "auto", "h_anchor": "start", "color": "#000000", "text": "positive class", "coordinates": "axes", "zorder": 1000003.0, "alpha": 1, "fontsize": 12.0, "position": [0.825179211469534, 0.9234731420161886], "rotation": -0.0, "id": "el732154517566416"}, {"v_baseline": "auto", "h_anchor": "start", "color": "#000000", "text": "negative class", "coordinates": "axes", "zorder": 1000003.0, "alpha": 1, "fontsize": 12.0, "position": [0.825179211469534, 0.8535688005886684], "rotation": -0.0, "id": "el732154580902096"}], "zoomable": true, "images": [], "xdomain": [-29.93050003052, 34.54050064092], "ylim": [0.0, 0.1319991168390634], "paths": [{"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data02", "id": "el732154573001744"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data03", "id": "el732154573001168"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data04", "id": "el732154573002512"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data05", "id": "el732154573003408"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data06", "id": "el732154573041168"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data07", "id": "el732154573042064"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data08", "id": "el732154573042960"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data09", "id": "el732154573043856"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data10", "id": "el732154573044624"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data11", "id": "el732154573090768"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data12", "id": "el732154573091664"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data13", "id": "el732154573092560"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data14", "id": "el732154573093456"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data15", "id": "el732154573151760"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data16", "id": "el732154573152656"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data17", "id": "el732154573153552"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data18", "id": "el732154573154448"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data19", "id": "el732154573155216"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data20", "id": "el732154573201360"}, {"edgecolor": "none", "facecolor": "#008000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 1, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data21", "id": "el732154573202256"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data02", "id": "el732154573254608"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data03", "id": "el732154573254032"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data04", "id": "el732154573255376"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data05", "id": "el732154573256336"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data06", "id": "el732154573257168"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data07", "id": "el732154573303184"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data08", "id": "el732154573304080"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data09", "id": "el732154573304976"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data10", "id": "el732154573305872"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data11", "id": "el732154573306768"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data12", "id": "el732154573348688"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data13", "id": "el732154573349584"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data14", "id": "el732154573350480"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data15", "id": "el732154573351376"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data16", "id": "el732154573397392"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data17", "id": "el732154573398288"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data18", "id": "el732154573399184"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data19", "id": "el732154573400080"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data20", "id": "el732154573400976"}, {"edgecolor": "none", "facecolor": "#FF0000", "edgewidth": 1.0, "pathcodes": ["M", "L", "L", "L", "Z"], "yindex": 2, "coordinates": "data", "dasharray": "10,0", "zorder": 1, "alpha": 0.5, "xindex": 0, "data": "data21", "id": "el732154573451088"}, {"edgecolor": "none", "facecolor": "none", "edgewidth": 1.0, "pathcodes": ["M", "L", "S", "L", "S", "L", "S", "L", "S", "Z"], "yindex": 1, "coordinates": "axes", "dasharray": "10,0", "zorder": 1000001.0, "alpha": 0.0, "xindex": 0, "data": "data23", "id": "el732154573453456"}], "sharey": [], "sharex": [], "axesbgalpha": null, "axes": [{"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "fontsize": 10.0, "position": "bottom", "nticks": 8, "tickvalues": null}, {"scale": "linear", "tickformat": null, "grid": {"gridOn": false}, "fontsize": 10.0, "position": "left", "nticks": 8, "tickvalues": null}], "lines": [{"color": "#007F00", "yindex": 1, "coordinates": "data", "dasharray": "5.55,2.4", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el732154573001040"}, {"color": "#FF0000", "yindex": 2, "coordinates": "data", "dasharray": "5.55,2.4", "zorder": 2, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data01", "id": "el732154573253840"}, {"color": "#007F00", "yindex": 1, "coordinates": "axes", "dasharray": "5.55,2.4", "zorder": 1000002.0, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data22", "id": "el732154573454288"}, {"color": "#FF0000", "yindex": 2, "coordinates": "axes", "dasharray": "5.55,2.4", "zorder": 1000002.0, "alpha": 1, "xindex": 0, "linewidth": 1.5, "data": "data22", "id": "el732154580902608"}], "markers": [], "id": "el732154571635024", "ydomain": [0.0, 0.1319991168390634], "collections": [], "xscale": "linear", "bbox": [0.125, 0.125, 0.775, 0.755]}], "height": 360.0, "width": 720.0, "plugins": [{"type": "reset"}, {"enabled": false, "button": true, "type": "zoom"}, {"enabled": false, "button": true, "type": "boxzoom"}], "data": {"data06": [[-15.27799987792, 0.0, 0.0], [-12.347499847399998, 0.0, 0.0], [-12.347499847399998, 0.00906716469695808, 0.0008863064028688934], [-15.27799987792, 0.00906716469695808, 0.0008863064028688934]], "data08": [[-9.41699981688, 0.0, 0.0], [-6.48649978636, 0.0, 0.0], [-6.48649978636, 0.029324323285264325, 0.00814019896319494], [-9.41699981688, 0.029324323285264325, 0.00814019896319494]], "data09": [[-6.48649978636, 0.0, 0.0], [-3.5559997558399985, 0.0, 0.0], [-3.5559997558399985, 0.06126192250982954, 0.032030005911082994], [-6.48649978636, 0.06126192250982954, 0.032030005911082994]], "data20": [[25.749000549360005, 0.0, 0.0], [28.679500579880006, 0.0, 0.0], [28.679500579880006, 4.880067113540411e-06, 1.2857595556036815e-05], [25.749000549360005, 4.880067113540411e-06, 1.2857595556036815e-05]], "data21": [[28.679500579880006, 0.0, 0.0], [31.6100006104, 0.0, 0.0], [31.6100006104, 4.880067113540434e-06, 8.519143067803573e-06], [28.679500579880006, 4.880067113540434e-06, 8.519143067803573e-06]], "data22": [[0.764964157706093, 0.9389256806475351, 0.8690213392200149], [0.8079749103942651, 0.9389256806475351, 0.8690213392200149]], "data05": [[-18.20849990844, 0.0, 0.0], [-15.27799987792, 0.0, 0.0], [-15.27799987792, 0.006222085569764024, 0.0006932847076196783], [-18.20849990844, 0.006222085569764024, 0.0006932847076196783]], "data02": [[-27.0, 0.0, 0.0], [-24.06949996948, 0.0, 0.0], [-24.06949996948, 0.0001878825838713058, 6.941523981173248e-06], [-27.0, 0.0001878825838713058, 6.941523981173248e-06]], "data04": [[-21.138999938959998, 0.0, 0.0], [-18.20849990844, 0.0, 0.0], [-18.20849990844, 0.0017397439259771606, 0.0002698517447681107], [-21.138999938959998, 0.0017397439259771606, 0.0002698517447681107]], "data01": [[-27.0, 1.2510158185326837e-06, 3.402148637038758e-13], [-24.06949996948, 1.4679995451412345e-05, 7.77931921378068e-11], [-21.138999938959998, 0.0001261957054457412, 9.540696119895418e-09], [-18.20849990844, 0.000794728459111368, 6.275794239237008e-07], [-15.27799987792, 0.0036664729882356153, 2.214152302739422e-05], [-12.347499847399998, 0.012391781559902424, 0.0004189830440176699], [-9.41699981688, 0.030681355542180554, 0.004252414265404293], [-6.48649978636, 0.05565073088964497, 0.023148606210646717], [-3.5559997558399985, 0.07394737067551162, 0.06758717428915056], [-0.6254997253199974, 0.07198303196407828, 0.10584099019872663], [2.3050003052000037, 0.05133257722660622, 0.08889834191220669], [5.235500335720005, 0.026817083104422927, 0.040048254238764715], [8.166000366239999, 0.01026326497048705, 0.00967661984628424], [11.09650039676, 0.0028774983270843375, 0.0012540473425793747], [14.02700042728, 0.0005910172449834048, 8.716745106529495e-05], [16.957500457800002, 8.892845789693055e-05, 3.2497123656776868e-06], [19.888000488320003, 9.802501205418384e-06, 6.49808908977726e-08], [22.818500518840004, 7.915686438904463e-07, 6.969097838423678e-10], [25.749000549360005, 4.6826941757603034e-08, 4.008829852706381e-12], [28.679500579880006, 2.0293574159191406e-09, 1.2368266886782716e-14], [31.6100006104, 6.442832273552862e-11, 2.0466813596639995e-17]], "data23": [[0.7606630824372759, 0.824871228844739], [0.9849462365591398, 0.824871228844739], [0.9892473118279571, 0.824871228844739], [0.9892473118279571, 0.8337012509197941], [0.9892473118279571, 0.9690949227373071], [0.9892473118279571, 0.9779249448123624], [0.9849462365591398, 0.9779249448123624], [0.7606630824372759, 0.9779249448123624], [0.7563620071684587, 0.9779249448123624], [0.7563620071684587, 0.9690949227373071], [0.7563620071684587, 0.8337012509197941], [0.7563620071684587, 0.824871228844739], [0.7606630824372759, 0.824871228844739]], "data03": [[-24.06949996948, 0.0, 0.0], [-21.138999938959998, 0.0, 0.0], [-21.138999938959998, 0.001080934865649201, 8.21939544134378e-05], [-24.06949996948, 0.001080934865649201, 8.21939544134378e-05]], "data07": [[-12.347499847399998, 0.0, 0.0], [-9.41699981688, 0.0, 0.0], [-9.41699981688, 0.009316048119748666, 0.002062815836723433], [-12.347499847399998, 0.009316048119748666, 0.002062815836723433]], "data19": [[22.818500518840004, 0.0, 0.0], [25.749000549360005, 0.0, 0.0], [25.749000549360005, 3.172043623801267e-05, 2.934371501132328e-05], [22.818500518840004, 3.172043623801267e-05, 2.934371501132328e-05]], "data18": [[19.888000488320003, 0.0, 0.0], [22.818500518840004, 0.0, 0.0], [22.818500518840004, 9.02812416004976e-05, 3.178902459560022e-05], [19.888000488320003, 9.02812416004976e-05, 3.178902459560022e-05]], "data15": [[11.09650039676, 0.0, 0.0], [14.02700042728, 0.0, 0.0], [14.02700042728, 0.001976427180983866, 0.0019892987872864565], [11.09650039676, 0.001976427180983866, 0.0019892987872864565]], "data14": [[8.166000366239999, 0.0, 0.0], [11.09650039676, 0.0, 0.0], [11.09650039676, 0.0029036399325565437, 0.004393905799128336], [8.166000366239999, 0.0029036399325565437, 0.004393905799128336]], "data17": [[16.957500457800002, 0.0, 0.0], [19.888000488320003, 0.0, 0.0], [19.888000488320003, 0.00015616214763329315, 0.0002327776962322984], [16.957500457800002, 0.00015616214763329315, 0.0002327776962322984]], "data16": [[14.02700042728, 0.0, 0.0], [16.957500457800002, 0.0, 0.0], [16.957500457800002, 0.0009198926509023674, 0.0006035181815904151], [14.02700042728, 0.0009198926509023674, 0.0006035181815904151]], "data11": [[-0.6254997253199974, 0.0, 0.0], [2.3050003052000037, 0.0, 0.0], [2.3050003052000037, 0.08065530921903914, 0.12571344460863182], [-0.6254997253199974, 0.08065530921903914, 0.12571344460863182]], "data10": [[-3.5559997558399985, 0.0, 0.0], [-0.6254997253199974, 0.0, 0.0], [-0.6254997253199974, 0.09364116780817015, 0.09552128605251878], [-3.5559997558399985, 0.09364116780817015, 0.09552128605251878]], "data13": [[5.235500335720005, 0.0, 0.0], [8.166000366239999, 0.0, 0.0], [8.166000366239999, 0.009367288824440864, 0.013270142947190696], [5.235500335720005, 0.009367288824440864, 0.013270142947190696]], "data12": [[2.3050003052000037, 0.0, 0.0], [5.235500335720005, 0.0, 0.0], [5.235500335720005, 0.033286937781459136, 0.05526021031885093], [2.3050003052000037, 0.033286937781459136, 0.05526021031885093]]}, "id": "el732154571633616"});
            })
         });
}
</script></div></div>
</div>
</div>
</div>
</div>
<div class="section" id="step-3-input-feature-selection">
<h2>Step 3: Input feature selection<a class="headerlink" href="#step-3-input-feature-selection" title="Permalink to this headline">¶</a></h2>
<p>NOTE: This step may take roughly three hours (judged using Mac 2.6 GHz Intel Core i7 machine). Here is the output from a previous evaluation of the feature selection algorithm:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>   CPU times: user 2h 56min 50s, sys: 9min 37s, total: 3h 6min 28s
   Wall time: 3h 6min 31s
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span><span class="p">,</span> <span class="n">f_classif</span>

<span class="c1"># specify the number of features to keep based on univariate analysis of variance F-score</span>
<span class="n">numFeatures</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">fSelect_model</span> <span class="o">=</span> <span class="n">SelectKBest</span><span class="p">(</span><span class="n">score_func</span><span class="o">=</span><span class="n">f_classif</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">numFeatures</span><span class="p">)</span>
<span class="n">X_fSelect</span> <span class="o">=</span> <span class="n">fSelect_model</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> 
    <span class="c1"># FIT: Run score function on (X, y) and get the appropriate features</span>
    <span class="c1"># TRANSFORM: Reduce X to the selected features</span>
<span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;number of selected features = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_fSelect</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span> <span class="p">)</span>

<span class="n">scores</span> <span class="o">=</span> <span class="n">fSelect_model</span><span class="o">.</span><span class="n">scores_</span>
<span class="nb">print</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>

<span class="n">selected_feature_labels</span> <span class="o">=</span> <span class="n">feature_labels</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">argwhere</span><span class="p">(</span><span class="n">fSelect_model</span><span class="o">.</span><span class="n">get_support</span><span class="p">()</span> <span class="o">==</span> <span class="kc">True</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">selected_feature_labels</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f_classif is an ANOVA F-test to determine </span><span class="se">\n</span><span class="s1">  the probability that the means of the </span><span class="se">\n</span><span class="s1">  input variables are the same as the mean </span><span class="se">\n</span><span class="s1">  of the target variable&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The higher the value, the greater </span><span class="se">\n</span><span class="s1">  the probability that the two means are different&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;.....And, therefore, the more information </span><span class="se">\n</span><span class="s1">    that variable provides on the target variable</span><span class="se">\n\n</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;the F-test ignores correlations between the variables and is, therefore, </span><span class="se">\n</span><span class="s1">    a univariate feature selection algorithm&#39;</span><span class="p">)</span>

<span class="c1"># Examine the selected features more intuitively </span>
<span class="c1">#     It&#39;s not easy to interpret the scores in this fashion, so let&#39;s plot the results</span>
<span class="n">scores</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">scores</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">0.</span>
<span class="n">mpld3</span><span class="o">.</span><span class="n">disable_notebook</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="n">order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">scores</span><span class="p">)</span>
<span class="n">orderedfeaturelabels</span> <span class="o">=</span> <span class="p">[</span><span class="n">feature_labels</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">order</span><span class="p">]</span>
<span class="n">y_pos2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">feature_labels</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">y_pos2</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">scores</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">scores</span><span class="p">)),</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">numFeatures</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">y_pos2</span><span class="p">,</span> <span class="n">orderedfeaturelabels</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Normalized Fisher Score&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Ranking of features&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="c1">#fig.savefig(&#39;features_FisherScores.png&#39;,bbox_inches=&#39;tight&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>number of selected features = 25
[ 1.09947677  1.10297638  1.06421947  1.31496273  1.06887737  1.52599307
  1.53485315  1.53737494  1.24615812  1.24599368  1.24395107  1.15054259
  1.15448392  1.15763263  1.5557883   1.55384408  1.55845813  2.00312905
  2.10137823  2.17030351  1.58726344  1.5995239   1.61120943  0.88005718
  0.87193584  0.86945365  1.99384039  2.01314053  2.04182759  1.10889267
  1.15467842  1.20312287  1.80807842  1.10323435  1.91774916  2.22863842
  2.47390683  1.92082455  2.24680201  2.33236914  1.42284365  1.37082677
  1.02011598  1.00754248  1.46513361  1.37318223  1.11137108  1.9397745
  1.23046477  3.03546661  1.29557806  3.32709783]
[[&#39;Bz - 30min [nT]&#39;]
 [&#39;Bz - 15min [nT]&#39;]
 [&#39;Bz - 0min [nT]&#39;]
 [&#39;Psw - 30min [nPa]&#39;]
 [&#39;Psw - 15min [nPa]&#39;]
 [&#39;Psw - 0min [nPa]&#39;]
 [&#39;AE - 30min [nT]&#39;]
 [&#39;AE - 15min [nT]&#39;]
 [&#39;AE - 0min [nT]&#39;]
 [&#39;SymH - 30min [nT]&#39;]
 [&#39;SymH - 15min [nT]&#39;]
 [&#39;SymH - 0min [nT]&#39;]
 [&#39;Newell CF - 30min [m/s^(4/3) T^(2/3)]&#39;]
 [&#39;Newell CF - 15min [m/s^(4/3) T^(2/3)]&#39;]
 [&#39;Newell CF - 0min [m/s^(4/3) T^(2/3)]&#39;]
 [&#39;Kp [dimensionless]&#39;]
 [&#39;OVATION diffuse eflux [erg/cm^2/s]&#39;]
 [&#39;OVATION mono eflux [erg/cm^2/s]&#39;]
 [&#39;OVATION wave eflux [erg/cm^2/s]&#39;]
 [&#39;OVATION diffuse nflux [#/cm^2/s]&#39;]
 [&#39;OVATION mono nflux [#/cm^2/s]&#39;]
 [&#39;OVATION wave nflux [#/cm^2/s]&#39;]
 [&#39;dTEC 0min-15s to 0min-0s [TECU]&#39;]
 [&#39;spectral slope [dimensionless]&#39;]
 [&#39;sigmaPhi projected to vertical [radians]&#39;]]
f_classif is an ANOVA F-test to determine 
  the probability that the means of the 
  input variables are the same as the mean 
  of the target variable
The higher the value, the greater 
  the probability that the two means are different
.....And, therefore, the more information 
    that variable provides on the target variable


the F-test ignores correlations between the variables and is, therefore, 
    a univariate feature selection algorithm
</pre></div>
</div>
<img alt="../_images/notebook_14_1.png" src="../_images/notebook_14_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 3h 34min 8s, sys: 58.1 s, total: 3h 35min 6s
Wall time: 3h 36min 13s
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="step-4-support-vector-machine-svm-training">
<h2>Step 4: Support Vector Machine (SVM) training<a class="headerlink" href="#step-4-support-vector-machine-svm-training" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">svm</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span><span class="p">,</span> <span class="n">RobustScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">confusion_matrix</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">average_precision_score</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># Convert y to binary values (1=scintillation; 0=no-scintillation)</span>
<span class="n">y</span><span class="p">[</span><span class="n">y</span><span class="o">&gt;</span><span class="n">scint_thresh</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">y</span><span class="p">[</span><span class="n">y</span><span class="o">&lt;=</span><span class="n">scint_thresh</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>



<span class="c1"># Set a desired number of data samples with which to train SVM</span>
<span class="n">numsamples</span> <span class="o">=</span> <span class="mi">50000</span>

<span class="c1"># Set a random seed for reproducibility</span>
<span class="n">randomseed</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Separate data into training and testing data</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_fSelect</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
                                                                                 <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span>
                                                                                 <span class="n">train_size</span><span class="o">=</span><span class="n">numsamples</span><span class="p">,</span>
                                                                                 <span class="n">random_state</span><span class="o">=</span><span class="n">randomseed</span><span class="p">)</span>

<span class="c1"># Create input data scaler based only on training set</span>
<span class="n">scaler_X</span> <span class="o">=</span> <span class="n">RobustScaler</span><span class="p">()</span>
<span class="n">scaler_X</span> <span class="o">=</span> <span class="n">scaler_X</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler_X</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler_X</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Create the SVM model</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span><span class="n">C</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">class_weight</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">50</span><span class="p">},</span><span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>//anaconda/envs/python2/lib/python2.7/site-packages/sklearn/model_selection/_split.py:2026: FutureWarning: From version 0.21, test_size will always complement train_size unless both are specified.
  FutureWarning)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 10min 11s, sys: 9.11 s, total: 10min 20s
Wall time: 10min 22s
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="step-5-svm-evaluation">
<h2>Step 5: SVM evaluation<a class="headerlink" href="#step-5-svm-evaluation" title="Permalink to this headline">¶</a></h2>
<p>We use a variety of evaluation metrics to gauge model performance, but emphasize the Total Skill Score (TSS) here due to its insensitivity on class imbalance ratio [<a class="reference external" href="http://iopscience.iop.org/article/10.1088/2041-8205/747/2/L41/meta">Bloomfield et al., 2012</a>]. All metrics require the use of the entries of the contingency, or confusion matix. For the scintillation/no-scintillation classification problem the matrix is https://github.com/rmcgranaghan/machine-learning-with-GNSS-data/blob/master/confusion_matrix_schematic.png.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to calculate the confusion matrix entries</span>
<span class="k">def</span> <span class="nf">confusion_table</span><span class="p">(</span><span class="n">true</span><span class="p">,</span> <span class="n">pred</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    computes the number of TP, TN, FP, FN events given the arrays with observations and predictions</span>
<span class="sd">    and returns the true skill score</span>
<span class="sd">  </span>
<span class="sd">    Args:</span>
<span class="sd">    true: np array with observations (1 for scintillation, 0 for nonscintillation)</span>
<span class="sd">    pred: np array with predictions (1 for scintillation, 0 for nonscintillation)</span>
<span class="sd">  </span>
<span class="sd">    Returns: true negative, false positive, true positive, false negative</span>
<span class="sd">    &quot;&quot;&quot;</span>  
    <span class="n">Nobs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pred</span><span class="p">)</span>
    <span class="n">TN</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">TP</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">FP</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">FN</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nobs</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">true</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">TN</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">true</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">FP</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">true</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">TP</span> <span class="o">+=</span> <span class="mi">1</span> 
        <span class="k">elif</span> <span class="p">(</span><span class="n">pred</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">true</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">FN</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error! Observation could not be classified.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">TN</span><span class="p">,</span><span class="n">FP</span><span class="p">,</span><span class="n">TP</span><span class="p">,</span><span class="n">FN</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function to plot the confusion matrix</span>
<span class="k">def</span> <span class="nf">plot_confusion_matrix</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span>
                          <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Confusion matrix&#39;</span><span class="p">,</span>
                          <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">Blues</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function prints and plots the confusion matrix.</span>
<span class="sd">    Normalization can be applied by setting `normalize=True`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">normalize</span><span class="p">:</span>
        <span class="n">cm</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;float&#39;</span><span class="p">)</span> <span class="o">/</span> <span class="n">cm</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Normalized confusion matrix&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Confusion matrix, without normalization&#39;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">cm</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;nearest&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
    <span class="n">cb</span><span class="o">.</span><span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span> 
    <span class="n">tick_marks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">classes</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">classes</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span><span class="c1">#,fontsize=22, weight=&#39;bold&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">tick_marks</span><span class="p">,</span> <span class="n">classes</span><span class="p">)</span><span class="c1">#,fontsize=22, weight=&#39;bold&#39;)</span>

    <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;.2f&#39;</span> <span class="k">if</span> <span class="n">normalize</span> <span class="k">else</span> <span class="s1">&#39;d&#39;</span>
    <span class="n">thresh</span> <span class="o">=</span> <span class="n">cm</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">itertools</span><span class="o">.</span><span class="n">product</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">range</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="nb">format</span><span class="p">(</span><span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">],</span> <span class="n">fmt</span><span class="p">),</span>
                 <span class="n">horizontalalignment</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
                 <span class="n">color</span><span class="o">=</span><span class="s2">&quot;white&quot;</span> <span class="k">if</span> <span class="n">cm</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">thresh</span> <span class="k">else</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">22</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;True label&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Predicted label&#39;</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="c1"># Test and evaluate</span>
<span class="n">pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">)</span>

<span class="n">TN</span><span class="p">,</span><span class="n">FP</span><span class="p">,</span><span class="n">TP</span><span class="p">,</span><span class="n">FN</span> <span class="o">=</span> <span class="n">confusion_table</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">pred</span><span class="p">)</span>

<span class="c1"># Calculate the predictive metrics</span>
<span class="n">TSS</span> <span class="o">=</span> <span class="p">(</span><span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span> <span class="o">-</span> <span class="n">FP</span><span class="o">/</span><span class="p">(</span><span class="n">FP</span><span class="o">+</span><span class="n">TN</span><span class="p">))</span>

<span class="n">AUC_PRC</span> <span class="o">=</span> <span class="p">(</span><span class="n">average_precision_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="n">pred</span><span class="p">))</span>

<span class="n">precision</span> <span class="o">=</span> <span class="p">(</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FP</span><span class="p">)</span> <span class="p">)</span>

<span class="n">recall</span> <span class="o">=</span> <span class="p">(</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span> <span class="p">)</span>

<span class="n">specificity</span> <span class="o">=</span> <span class="p">(</span> <span class="n">TN</span><span class="o">/</span><span class="p">(</span><span class="n">TN</span><span class="o">+</span><span class="n">FP</span><span class="p">)</span> <span class="p">)</span>

<span class="n">F1</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">precision</span><span class="o">*</span><span class="n">recall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">precision</span><span class="o">+</span><span class="n">recall</span><span class="p">))</span> <span class="p">)</span>

<span class="n">confusion_matrix_svm</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">pred</span><span class="p">)</span>

<span class="n">confusion_matrix_class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;no scintillation&#39;</span><span class="p">,</span><span class="s1">&#39;scintillation&#39;</span><span class="p">]</span>
<span class="n">fig1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">confusion_matrix_svm</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">confusion_matrix_class_names</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;SVM: Confusion matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">confusion_matrix_svm</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">confusion_matrix_class_names</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">title</span><span class="o">=</span><span class="s1">&#39;SVM: Normalized Confusion matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion matrix, without normalization
[[3123127 1154453]
 [  16503  121763]]
</pre></div>
</div>
<img alt="../_images/notebook_20_1.png" src="../_images/notebook_20_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Normalized confusion matrix
[[ 0.73011539  0.26988461]
 [ 0.11935689  0.88064311]]
</pre></div>
</div>
<img alt="../_images/notebook_20_3.png" src="../_images/notebook_20_3.png" />
</div>
</div>
<div class="section" id="determine-sensitivity-to-input-training-sample">
<h3>Determine sensitivity to input training sample<a class="headerlink" href="#determine-sensitivity-to-input-training-sample" title="Permalink to this headline">¶</a></h3>
<p>NOTE: Each evaluation in the block below will take approximately one hour</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="c1"># Benchmark the SVM model</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="s1">&#39;rbf&#39;</span><span class="p">,</span><span class="n">C</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span><span class="n">class_weight</span><span class="o">=</span><span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="mi">50</span><span class="p">},</span><span class="n">probability</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Set the number of samples to use for SVM model training on each loop</span>
<span class="n">numsamples</span> <span class="o">=</span> <span class="mi">50000</span>

<span class="c1"># Set a subset of samples to be predicted to speed up execution of this block</span>
<span class="n">numpredsamples</span> <span class="o">=</span> <span class="mi">50000</span>


<span class="c1"># Set the number of independent SVM models to train</span>
<span class="n">num_evals</span> <span class="o">=</span> <span class="mi">10</span>

<span class="c1"># Specify save array for total skill score (TSS)</span>
<span class="n">array_of_TSS</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_evals</span><span class="p">)</span>

<span class="c1"># Loop over number of evaluations, fit model, and calculate benchmark scores</span>
<span class="n">ctr</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">randomseed</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_evals</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;working on eval = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span> <span class="s1">&#39;current time = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">time</span><span class="p">())</span> <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;progress = </span><span class="si">{0}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="p">(</span><span class="n">e</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">num_evals</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span> <span class="p">))</span>
    

    <span class="c1"># Set a different random seed on each loop</span>
    <span class="n">randomseed</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;seed for random generator on eval </span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">randomseed</span><span class="p">))</span>    

    <span class="c1"># Separate data into training and testing data</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">idx_train</span><span class="p">,</span> <span class="n">idx_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_fSelect</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> 
                                                                                     <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)),</span>
                                                                                     <span class="n">train_size</span><span class="o">=</span><span class="n">numsamples</span><span class="p">,</span>
                                                                                     <span class="n">random_state</span><span class="o">=</span><span class="n">randomseed</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;size of testing data = </span><span class="si">{0}</span><span class="s1">x</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_test</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;size of training data = </span><span class="si">{0}</span><span class="s1">x</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_train</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;--------------------------------------------------------------------------------&#39;</span><span class="p">)</span>
    
    <span class="c1"># Create input data scaler based only on training set</span>
    <span class="n">scaler_X</span> <span class="o">=</span> <span class="n">RobustScaler</span><span class="p">()</span>
    <span class="n">scaler_X</span> <span class="o">=</span> <span class="n">scaler_X</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

    <span class="n">X_train_scaled</span> <span class="o">=</span> <span class="n">scaler_X</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
    <span class="n">X_test_scaled</span> <span class="o">=</span> <span class="n">scaler_X</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="c1"># Fit the model to the training data</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train_scaled</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
    
    <span class="n">pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_scaled</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">numpredsamples</span><span class="p">])</span>
    
    <span class="n">TN</span><span class="p">,</span><span class="n">FP</span><span class="p">,</span><span class="n">TP</span><span class="p">,</span><span class="n">FN</span> <span class="o">=</span> <span class="n">confusion_table</span><span class="p">(</span><span class="n">y_test</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">numpredsamples</span><span class="p">],</span> <span class="n">pred</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="p">(((</span><span class="n">TP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">FP</span><span class="o">+</span><span class="n">TN</span><span class="p">)</span><span class="o">==</span><span class="mf">0.0</span><span class="p">):</span>
        <span class="n">array_of_TSS</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">array_of_TSS</span><span class="p">[</span><span class="n">ctr</span><span class="p">]</span> <span class="o">=</span> <span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span> <span class="o">-</span> <span class="n">FP</span><span class="o">/</span><span class="p">(</span><span class="n">FP</span><span class="o">+</span><span class="n">TN</span><span class="p">)</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;TSS for eval </span><span class="si">{0}</span><span class="s1"> = </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="n">array_of_TSS</span><span class="p">[</span><span class="n">ctr</span><span class="p">]))</span>

    <span class="n">ctr</span> <span class="o">+=</span> <span class="mi">1</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>working on eval = 0
current time = 22:44:27.343090
progress = 0.0
seed for random generator on eval 0 = 1
size of testing data = 4415846x25
size of training data = 50000x25

--------------------------------------------------------------------------------
TSS for eval 0 = 0.608818007852
working on eval = 1
current time = 22:55:15.283790
progress = 10.0
seed for random generator on eval 1 = 2
size of testing data = 4415846x25
size of training data = 50000x25

--------------------------------------------------------------------------------
TSS for eval 1 = 0.607159633327
working on eval = 2
current time = 23:06:09.363322
progress = 20.0
seed for random generator on eval 2 = 3
size of testing data = 4415846x25
size of training data = 50000x25

--------------------------------------------------------------------------------
TSS for eval 2 = 0.599259167496
working on eval = 3
current time = 23:16:46.806083
progress = 30.0
seed for random generator on eval 3 = 4
size of testing data = 4415846x25
size of training data = 50000x25

--------------------------------------------------------------------------------
TSS for eval 3 = 0.612443695518
working on eval = 4
current time = 23:27:46.192700
progress = 40.0
seed for random generator on eval 4 = 5
size of testing data = 4415846x25
size of training data = 50000x25

--------------------------------------------------------------------------------
TSS for eval 4 = 0.606470367797
working on eval = 5
current time = 23:38:25.213867
progress = 50.0
seed for random generator on eval 5 = 6
size of testing data = 4415846x25
size of training data = 50000x25

--------------------------------------------------------------------------------
TSS for eval 5 = 0.615061596552
working on eval = 6
current time = 23:49:09.575116
progress = 60.0
seed for random generator on eval 6 = 7
size of testing data = 4415846x25
size of training data = 50000x25

--------------------------------------------------------------------------------
TSS for eval 6 = 0.602731572755
working on eval = 7
current time = 23:59:30.501835
progress = 70.0
seed for random generator on eval 7 = 8
size of testing data = 4415846x25
size of training data = 50000x25

--------------------------------------------------------------------------------
TSS for eval 7 = 0.603645873014
working on eval = 8
current time = 00:10:15.350048
progress = 80.0
seed for random generator on eval 8 = 9
size of testing data = 4415846x25
size of training data = 50000x25

--------------------------------------------------------------------------------
TSS for eval 8 = 0.61568014733
working on eval = 9
current time = 00:21:09.789909
progress = 90.0
seed for random generator on eval 9 = 10
size of testing data = 4415846x25
size of training data = 50000x25

--------------------------------------------------------------------------------
TSS for eval 9 = 0.592463188245
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ValueError</span><span class="g g-Whitespace">                                </span>Traceback (most recent call last)
<span class="nn">&lt;ipython-input-27-c77cf017b810&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>
<span class="nn">----&gt; 1 get_ipython().run_cell_magic(u&#39;time&#39;, u&#39;&#39;, u&quot;\n# Benchmark the SVM model\nclf = svm.SVC(kernel=&#39;rbf&#39;,C=0.1,gamma=0.01,class_weight={1:50},probability=True)\n\n# Set the number of samples to use for SVM model training on each loop\nnumsamples = 50000\n\n# Set a subset of samples to be predicted to speed up execution of this block\nnumpredsamples = 50000\n\n\n# Set the number of independent SVM models to train\nnum_evals = 10\n\n# Specify save array for total skill score (TSS)\narray_of_TSS = np.zeros(num_evals)\n\n# Loop over number of evaluations, fit model, and calculate benchmark scores\nctr = 0\nrandomseed = 0\nfor e</span> in <span class="ni">range(num_evals):\n    print(&#39;working on eval = {0}&#39;.format(e))\n    print( &#39;current time = {0}&#39;.format(datetime.datetime.now().time()) )\n    print(&#39;progress = {0}&#39;.format( (e/float(num_evals))*100 ))\n    \n\n    # Set a different random seed on each loop\n    randomseed += 1\n    print(&#39;seed for random generator on eval {0} = {1}&#39;.format(e,randomseed))    \n\n    # Separate data into training and testing data\n    X_train, X_test, y_train, y_test, idx_train, idx_test = train_test_split(X_fSelect, y, \n                                                                                     range(len(y)),\n                                                                                     train_size=numsamples,\n                                                                                     random_state=randomseed)\n    \n    print(&#39;size of testing data = {0}x{1}&#39;.format(np.shape(X_test)[0],np.shape(X_test)[1]))\n    print(&#39;size of training data = {0}x{1}&#39;.format(np.shape(X_train)[0],np.shape(X_train)[1]))\n    print(&#39;&#39;)\n    print(&#39;--------------------------------------------------------------------------------&#39;)\n    \n    # Create input data scaler based only on training set\n    scaler_X = RobustScaler()\n    scaler_X = scaler_X.fit(X_train)\n\n    X_train_scaled = scaler_X.transform(X_train)\n    X_test_scaled = scaler_X.transform(X_test)\n\n    # Fit the model to the training data\n    clf.fit(X_train_scaled,y_train)\n    \n    pred = clf.predict(X_test_scaled[0:numpredsamples])\n    \n    TN,FP,TP,FN = confusion_table(y_test[0:numpredsamples], pred)\n    \n    if (((TP+FN) == 0.0) or (FP+TN)==0.0):\n        array_of_TSS[ctr] = -1.0\n    else:\n        array_of_TSS[ctr] = TP/(TP+FN) - FP/(FP+TN)\n    \n    print(&#39;TSS for eval {0} = {1}&#39;.format(e,array_of_TSS[ctr]))\n\n    ctr += 1\n\n# Visualize the output\nfig, ax = plt.subplots(figsize=(10,8))\nplt.xlim(xmax = np.max(num_evals), xmin = 0)\nplt.ylim(ymax = -1, xmin = 1)\n\n# label the axes and the plot\ntext_style = dict(fontsize=16, fontdict={&#39;family&#39;: &#39;monospace&#39;})\nmarker_style_blue = dict(linestyle=&#39;&#39;, markersize=8, fillstyle=&#39;full&#39;,color=cornblue,markeredgecolor=cornblue)\nax.plot(range(num_evals), array_of_TSS[i],&#39;o&#39;,**marker_style_blue)\nax.set_xlabel(&#39;eval number&#39;,**text_style)\nax.set_ylabel(&#39;TSS&#39;,labelpad=20,**text_style)\nplt.title(r&#39;TSS per eval using different subsets for training data&#39;,**text_style)\nfig = plt.gcf()\n\nplt.show</span><span class="nt">()\n    &quot;)</span>

<span class="nn">//anaconda/envs/python2/lib/python2.7/site-packages/IPython/core/interactiveshell.pyc</span> in <span class="ni">run_cell_magic</span><span class="nt">(self, magic_name, line, cell)</span>
<span class="g g-Whitespace">   </span><span class="mi">2113</span>             <span class="n">magic_arg_s</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_expand</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="n">stack_depth</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2114</span>             <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">builtin_trap</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">2115</span>                 <span class="n">result</span> <span class="o">=</span> <span class="n">fn</span><span class="p">(</span><span class="n">magic_arg_s</span><span class="p">,</span> <span class="n">cell</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">2116</span>             <span class="k">return</span> <span class="n">result</span>
<span class="g g-Whitespace">   </span><span class="mi">2117</span> 

<span class="nn">&lt;decorator-gen-59&gt;</span> in <span class="ni">time</span><span class="nt">(self, line, cell, local_ns)</span>

<span class="nn">//anaconda/envs/python2/lib/python2.7/site-packages/IPython/core/magic.pyc</span> in <span class="ni">&lt;lambda&gt;</span><span class="nt">(f, *a, **k)</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span>     <span class="c1"># but it&#39;s overkill for just that one bit of state.</span>
<span class="g g-Whitespace">    </span><span class="mi">187</span>     <span class="k">def</span> <span class="nf">magic_deco</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">188</span>         <span class="n">call</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">f</span><span class="p">,</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">:</span> <span class="n">f</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="o">**</span><span class="n">k</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">189</span> 
<span class="g g-Whitespace">    </span><span class="mi">190</span>         <span class="k">if</span> <span class="n">callable</span><span class="p">(</span><span class="n">arg</span><span class="p">):</span>

<span class="nn">//anaconda/envs/python2/lib/python2.7/site-packages/IPython/core/magics/execution.pyc</span> in <span class="ni">time</span><span class="nt">(self, line, cell, local_ns)</span>
<span class="g g-Whitespace">   </span><span class="mi">1178</span>         <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1179</span>             <span class="n">st</span> <span class="o">=</span> <span class="n">clock2</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1180</span>             <span class="n">exec</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">glob</span><span class="p">,</span> <span class="n">local_ns</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1181</span>             <span class="n">end</span> <span class="o">=</span> <span class="n">clock2</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1182</span>             <span class="n">out</span> <span class="o">=</span> <span class="kc">None</span>

<span class="nn">&lt;timed exec&gt;</span> in <span class="ni">&lt;module&gt;</span><span class="nt">()</span>

<span class="nn">//anaconda/envs/python2/lib/python2.7/site-packages/matplotlib/pyplot.pyc</span> in <span class="ni">ylim</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1546</span>     <span class="k">if</span> <span class="ow">not</span> <span class="n">args</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">kwargs</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">1547</span>         <span class="k">return</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1548</span>     <span class="n">ret</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1549</span>     <span class="k">return</span> <span class="n">ret</span>
<span class="g g-Whitespace">   </span><span class="mi">1550</span> 

<span class="nn">//anaconda/envs/python2/lib/python2.7/site-packages/matplotlib/axes/_base.pyc</span> in <span class="ni">set_ylim</span><span class="nt">(self, bottom, top, emit, auto, **kw)</span>
<span class="g g-Whitespace">   </span><span class="mi">3218</span>             <span class="n">top</span> <span class="o">=</span> <span class="n">kw</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;ymax&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3219</span>         <span class="k">if</span> <span class="n">kw</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3220</span>             <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;unrecognized kwargs: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">list</span><span class="p">(</span><span class="n">kw</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">3221</span> 
<span class="g g-Whitespace">   </span><span class="mi">3222</span>         <span class="k">if</span> <span class="n">top</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">iterable</span><span class="p">(</span><span class="n">bottom</span><span class="p">):</span>

<span class="ne">ValueError</span>: unrecognized kwargs: [&#39;xmin&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualize the output</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">xmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">num_evals</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">xmin</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">ymin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># label the axes and the plot</span>
<span class="n">text_style</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontdict</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;family&#39;</span><span class="p">:</span> <span class="s1">&#39;monospace&#39;</span><span class="p">})</span>
<span class="n">cornblue</span>  <span class="o">=</span> <span class="p">(</span><span class="mf">0.39</span><span class="p">,</span><span class="mf">0.58</span><span class="p">,</span><span class="mf">0.93</span><span class="p">,</span><span class="mf">1.0</span><span class="p">)</span>            <span class="c1"># create a cornflower-blue color</span>
<span class="n">marker_style_blue</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">fillstyle</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">cornblue</span><span class="p">,</span><span class="n">markeredgecolor</span><span class="o">=</span><span class="n">cornblue</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">num_evals</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">array_of_TSS</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">marker_style_blue</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;eval number&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">text_style</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;TSS&#39;</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="o">**</span><span class="n">text_style</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;TSS per eval using different subsets for training data&#39;</span><span class="p">,</span><span class="o">**</span><span class="n">text_style</span><span class="p">)</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gcf</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/notebook_23_0.png" src="../_images/notebook_23_0.png" />
</div>
</div>
</div>
<div class="section" id="load-data-from-2016-and-examine-svm-model-generalizability-by-examining-predictions-for-january-15-25-2016-period">
<h3>Load data from 2016 and examine SVM model generalizability by examining predictions for January 15-25, 2016 period<a class="headerlink" href="#load-data-from-2016-and-examine-svm-model-generalizability-by-examining-predictions-for-january-15-25-2016-period" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ml_db_2016</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;/Users/ryanmc/Documents/gnss_dswg_pp_data/classificationExplorationOutput/&#39;</span><span class="p">,</span><span class="s1">&#39;ml_db_2016_NaNsDropped.csv&#39;</span><span class="p">))</span>
<span class="c1"># Drop two saved index columns</span>
<span class="n">ml_db_2016</span> <span class="o">=</span> <span class="n">ml_db_2016</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">ml_db_2016</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">])</span> 

<span class="n">date_limits</span> <span class="o">=</span> <span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">15</span><span class="p">),</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2016</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">)]</span>
<span class="n">doy_limits</span> <span class="o">=</span> <span class="p">[</span><span class="n">date_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()</span><span class="o">.</span><span class="n">tm_yday</span><span class="p">,</span> <span class="n">date_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">timetuple</span><span class="p">()</span><span class="o">.</span><span class="n">tm_yday</span><span class="p">]</span>
<span class="n">doy_mask_Jan15</span> <span class="o">=</span> <span class="p">(</span><span class="n">ml_db_2016</span><span class="p">[</span><span class="s1">&#39;doy&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">doy_limits</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">doy_mask_Jan25</span> <span class="o">=</span> <span class="p">(</span><span class="n">ml_db_2016</span><span class="p">[</span><span class="s1">&#39;doy&#39;</span><span class="p">]</span><span class="o">&lt;=</span><span class="n">doy_limits</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">ml_db_2016</span> <span class="o">=</span> <span class="n">ml_db_2016</span><span class="p">[</span> <span class="n">doy_mask_Jan15</span> <span class="o">&amp;</span> <span class="n">doy_mask_Jan25</span> <span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">ml_db_2016</span><span class="p">))</span>


<span class="c1"># Drop columns not used in our predictive task</span>
<span class="n">cols_to_remove</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;datetime&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;CHAIN station&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;CHAIN station model&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;CHAIN station ID number&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;AACGM local time [hr]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;sigmaPhi [radians]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;S4 [dimensionless]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;datetime at prediction time&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;ut at prediction time [sec]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;doy at prediction time [sec]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;TEC at prediction time [TECU]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;dTEC at prediction time [TECU]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;S4 at prediction time [dimensionless]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;S4 projected to vertical at prediction time [dimensionless]&#39;</span><span class="p">,</span>
                   <span class="s1">&#39;sigmaPhi at prediction time [radians]&#39;</span><span class="p">]</span>

<span class="n">ml_db_2016</span> <span class="o">=</span> <span class="n">ml_db_2016</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">cols_to_remove</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># Separate the ML DB into input (X) and label (y)</span>
<span class="n">predicted_label</span> <span class="o">=</span> <span class="s1">&#39;sigmaPhi projected to vertical at prediction time [radians]&#39;</span>
<span class="n">predicted_column</span> <span class="o">=</span> <span class="n">ml_db_2016</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="n">predicted_label</span><span class="p">)</span>
<span class="n">X_2016</span> <span class="o">=</span> <span class="n">ml_db_2016</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ml_db_2016</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">predicted_label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">feature_labels</span> <span class="o">=</span> <span class="n">ml_db_2016</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">ml_db_2016</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="n">predicted_label</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span>
<span class="n">y_2016</span> <span class="o">=</span> <span class="n">ml_db_2016</span><span class="p">[</span><span class="n">predicted_label</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>

<span class="c1"># Convert y to binary values (1=scintillation; 0=no-scintillation)</span>
<span class="n">y_2016</span><span class="p">[</span><span class="n">y_2016</span><span class="o">&gt;</span><span class="n">scint_thresh</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">y_2016</span><span class="p">[</span><span class="n">y_2016</span><span class="o">&lt;=</span><span class="n">scint_thresh</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Apply the F-Select results</span>
<span class="n">X_2016_fSelect</span> <span class="o">=</span> <span class="n">fSelect_model</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_2016</span><span class="p">)</span>
<span class="n">mask_features</span> <span class="o">=</span> <span class="n">fSelect_model</span><span class="o">.</span><span class="n">get_support</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shape X pre-transform = </span><span class="si">{0}</span><span class="s1">x</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_2016</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_2016</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>
<span class="n">X_2016_fSelect</span> <span class="o">=</span> <span class="n">X_2016</span><span class="p">[:,</span><span class="n">mask_features</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;shape X post-transform = </span><span class="si">{0}</span><span class="s1">x</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_2016_fSelect</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">X_2016_fSelect</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span>

<span class="c1"># Use the scaling from the original training data to emulate an operational forecasting scenario</span>
<span class="n">X_scaled_2016</span> <span class="o">=</span> <span class="n">scaler_X</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_2016_fSelect</span><span class="p">)</span>

<span class="n">pred_2016</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_scaled_2016</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(126426, 68)
shape X pre-transform = 126426x52
shape X post-transform = 126426x25
Confusion matrix, without normalization
[[90488 31609]
 [ 1091  3238]]
</pre></div>
</div>
<img alt="../_images/notebook_25_1.png" src="../_images/notebook_25_1.png" />
</div>
</div>
<div class="section" id="take-a-look-at-the-confusion-matrix-to-understand-model-performance">
<h4>Take a look at the confusion matrix to understand model performance<a class="headerlink" href="#take-a-look-at-the-confusion-matrix-to-understand-model-performance" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">TN</span><span class="p">,</span><span class="n">FP</span><span class="p">,</span><span class="n">TP</span><span class="p">,</span><span class="n">FN</span> <span class="o">=</span> <span class="n">confusion_table</span><span class="p">(</span><span class="n">y_2016</span><span class="p">,</span><span class="n">pred_2016</span><span class="p">)</span>

<span class="c1"># Calculate the predictive metrics</span>
<span class="n">TSS</span> <span class="o">=</span> <span class="p">(</span><span class="n">TP</span><span class="o">/</span><span class="p">(</span><span class="n">TP</span><span class="o">+</span><span class="n">FN</span><span class="p">)</span> <span class="o">-</span> <span class="n">FP</span><span class="o">/</span><span class="p">(</span><span class="n">FP</span><span class="o">+</span><span class="n">TN</span><span class="p">))</span>

<span class="n">confusion_matrix_svm_2016</span> <span class="o">=</span> <span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_2016</span><span class="p">,</span> <span class="n">pred_2016</span><span class="p">)</span>

<span class="n">confusion_matrix_class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;no scintillation&#39;</span><span class="p">,</span><span class="s1">&#39;scintillation&#39;</span><span class="p">]</span>
<span class="n">fig1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">confusion_matrix_svm_2016</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">confusion_matrix_class_names</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;SVM 2016: Confusion matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="n">fig2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">confusion_matrix_svm_2016</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">confusion_matrix_class_names</span><span class="p">,</span> <span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">title</span><span class="o">=</span><span class="s1">&#39;SVM 2016: Normalized Confusion matrix&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confusion matrix, without normalization
[[90488 31609]
 [ 1091  3238]]
</pre></div>
</div>
<img alt="../_images/notebook_27_1.png" src="../_images/notebook_27_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Normalized confusion matrix
[[ 0.74111567  0.25888433]
 [ 0.25202125  0.74797875]]
</pre></div>
</div>
<img alt="../_images/notebook_27_3.png" src="../_images/notebook_27_3.png" />
</div>
</div>
<p>For binary prediction there are four quadrants in the confusion matrix:</p>
<ol class="simple">
<li><p>True negatives (upper left quadrant): no scintillation is observed and correctly predicted</p></li>
<li><p>False positives (upper right quadrant): no scintillation is observed yet the model predicts scintillation</p></li>
<li><p>False negatives (bottom left quadrant): scintillation is observed yet the model predicts no scintillation</p></li>
<li><p>True positives (bottom right quadrant): scintillation is observed and correctly predicted</p></li>
</ol>
<p>A perfect model will yield 100% in the upper left and bottom right quadrants.</p>
<p>In these results, the model shows high accuracy both in predicting when scintillation occurred (75%) and when no scintillation occurred (74%), indicating skillful scintillation prediction.</p>
</div>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Aarons, J., &amp; Basu, S. (1994). Ionospheric amplitude and phase fluctuations at the GPS frequencies. In Proceedings of the 7th International Technical Meeting of the Satellite Division of The Institute of Navigation (ION GPS 1994), The Institute of Navigation, pp. 1569–1578.</p>
<p>Basu, S., MacKenzie, E., &amp; Basu, S. (1988). Ionospheric constraints on VHF/UHF communications links during solar maximum and minimum periods. Radio Science, 23(3), 363–378. https://doi.org/10.1029/RS023i003p00363.</p>
<p>Beutler, G., Rothacher, M., Schaer, S., Springer, T., Kouba, J., &amp; Neilan, R. (1999). The International GPS Service (IGS): An interdisciplinary service in support of Earth sciences. Advances in Space Research, 23(4), 631–653. https://doi.org/10.1016/S0273-1177(99)00160-X, satellite Dynamics, Orbit Analysis and Combination of Space Techniques.</p>
<p>Cherniak, I., Krankowski, A., &amp; Zakharenkova, I. (2014). Observation of the ionospheric irregularities over the Northern Hemisphere: Methodology and service. Radio Science, 49, 653–662. https://doi.org/10.1002/2014RS005433.</p>
<p>Cortes, C., &amp; Vapnik, V. (1995). Support-vector networks. Machine Learning, 20(3), 273–297. https://doi.org/10.1007/BF00994018.</p>
<p>Coster, A., &amp; Komjathy, A. (2008). Space weather and the global positioning system. Space Weather, 6, S06D04.
https://doi.org/10.1029/2008SW000400.</p>
<p>Duderstadt, J. J. (2001). Issues for science and engineering researchers in the digital age. Washington, DC: National Academy Press.</p>
<p>Kintner, P. M. (2001). Fading timescales associated with GPS signals and potential consequences. Radio Science, 36(4), 731–743. https://doi.org/10.1029/1999RS002310.</p>
<p>Kintner, P. M., Ledvina, B. M., &amp; de Paula, E. R. (2007). GPS and ionospheric scintillations. Space Weather, 5, S09003. https://doi.org/10.1029/2006SW000260.</p>
<p>McGranaghan, R.M., A.J. Mannucci, B.D Wilson, C.A. Mattmann, and R. Chadwick. (2018), New capabilities for prediction of high‐latitude ionospheric scintillation: A novel approach with machine learning, Space Weather, 16. https://doi.org/10.1029/2018SW002018.</p>
<p>Ren, X., Zhang, X., Xie, W., Zhang, K., Yuan, Y., &amp; Li, X. (2016). Global ionospheric modelling using multi-GNSS: BeiDou, Galileo, GLONASS and GPS. Scientific Reports, 6(1), 33499. https://doi.org/10.1038/srep33499.</p>
<p>Rizos, C., Montenbruck, O., Weber, G. R., Weber, R., &amp; Neilan, U. H. (2013). The IGS MGEX experiment as a milestone for a comprehensive multi-GNSS service. In Proceedings of the ION 2013 Pacific PNT Meeting, The Institute of Navigation, pp. 289–295.</p>
<p>Sadlier, G., Flytkjær, R., Sabri, F., &amp; Herr, D. (2017). The economic impact on the UK of a sisruption to GNSS. Innovate UK, UK Space Agency: Royal Institute of Navigation.</p>
<p>Tzelepis, C., &amp; Carreno, A. (2016). Concepts for NASA’s Communication and Navigation Architecture in Near Earth and Deep Space Domains; Strategies for affordable and scalable implementation of next generation relay systems with improved mission experience and reduced burden. In 34th AIAA International Communications Satellite Systems Conference. https://doi.org/10.2514/6.2016-5706.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./05"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="Scintillation_Prediction.html" title="previous page">Scintillation Prediction</a>
    <a class='right-next' id="next-link" href="../06/Spectra_of_Flaring_Active_Regions.html" title="next page">Spectra of Flaring Active Regions</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Monica Bobra and James Mason<br/>
        
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>